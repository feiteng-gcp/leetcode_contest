<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>462_loick.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>462_loick.py</CENTER></H3><HR>
<PRE>
<A NAME="0"></A><FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match27-1.html#0',3,'match27-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>class Solution:
    def minimumDistance(self, word: str) -&gt; int:
        &quot;&quot;&quot;
        states: {(f1, f2, i): dis}
        dis: {}
        &quot;&quot;&quot;
        def val(ch):
            return ord(ch)-ord('A')
        coors = {ch: (val(ch)//6, val(</B></FONT>ch)%6) for ch in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'}
    
        
        states = {(coors[word[0]], coor): 0 for coor in coors.values()}
        
        for i in range(len(word)):
            nx = {}
            cell = coors[word[i]]
            for s in states:
                f1, f2, dis = *s, states[s]
                d1 = dis + abs(f1[0]-cell[0]) + abs(f1[1]-cell[1])
                d2 = dis + abs(f2[0]-cell[0]) + abs(f2[1]-cell[1])
                val1 = nx.get((cell, f2), float('inf'))
                nx[(cell, f2)] = min(val1, d1)
                val2 = nx.get((f1, cell), float('inf'))
                nx[(f1, cell)] = min(val2, d2)
            states = nx
        return min(states.values())
                
        
            
</PRE>

</BODY>
</HTML>
