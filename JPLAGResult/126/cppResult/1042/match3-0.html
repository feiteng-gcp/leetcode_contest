<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>57_pentester.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>57_pentester.cpp</CENTER></H3><HR>
<PRE>
#define FOR(i, a, b) for (remove_cv&lt;remove_reference&lt;decltype(b)&gt;::type&gt;::type i = (a); i &lt; (b); i++)
#define REP(i, n) FOR(i, 0, n)
#define ROF(i, a, b) for (remove_cv&lt;remove_reference&lt;decltype(b)&gt;::type&gt;::type i = (b); --i &gt;= (a); )

class Solution {
  int a[31];
  int K;
  int dfs(int n) {
    if (!n) return 0;
    if (n == 1) return 0;
    int b[31];
    b[0] = 0;
    REP(i, n)
      b[i+1] = b[i]+a[i];
    int r = INT_MAX;
    for (int g = 0; g+K &lt;= n; g++) {
      a[g] = b[g+K]-b[g];
      copy(a+g+K, a+n, a+g+1);
      r = min(r, a[g] + dfs(n-K+1));
      REP(i, n)
        a[i] = b[i+1]-b[i];
    }
    return r;
  }
public:
  int mergeStones(vector&lt;int&gt;&amp; a, int K) {
    int n = a.size();
    if (n == 1) return 0;
    if (n&lt; K || (n-1)%(K-1)) return -1;
    vector&lt;int&gt; sum(n+1);
    REP(i, n)
      sum[i+1] = sum[i]+a[i];
    vector&lt;vector&lt;int&gt;&gt; s(n, vector&lt;int&gt;(n, INT_MAX/4));
    if (K == 2) {
      REP(i, n)
        s[i][i] = 0;
      ROF(i, 0, n)
        FOR(j, i+1, n)
          FOR(f, i, j)
            s[i][j] = min(s[i][j], s[i][f]+s[f+1][j] + sum[j+1]-sum[i]);
      return s[0][n-1];
    }

    if (K == 3) {
      ROF(i, 0, n)
        for (int j=i; j&lt;n; j+=K-1)
          if (j-i+1 &lt; K)
            s[i][j] = 0;
          else
            for (int f = i; f &lt; j; f+=K-1)
              for (int g = f+1; g &lt; j; g+=K-1)
                s[i][j] = min(s[i][j], s[i][f]+s[f+1][g]+s[g+1][j] + sum[j+1]-sum[i]);
      return s[0][n-1];
    }

    if (K == 4) {
      ROF(i, 0, n)
        for (int j=i; j&lt;n; j+=K-1)
<A NAME="0"></A>          if (j-i+1 &lt; K)
            s[i][j] = 0;
          else
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match3-1.html#0',3,'match3-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>            for (int f = i; f &lt; j; f+=K-1)
              for (int g = f+1; g &lt; j; g+=K-1)
                for (int h = g+1; h &lt; j; h+=K-1)
                  s[i][j] = min(s[i][j], s[i][f]+s[f+1][g]+s[g+1][h]+s[h+1][j] + sum[j+1]-sum[i]);</B></FONT>
      return s[0][n-1];
    }

    if (K == 5) {
      ROF(i, 0, n)
        for (int j=i; j&lt;n; j+=K-1)
<A NAME="1"></A>          if (j-i+1 &lt; K)
            s[i][j] = 0;
          else
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match3-1.html#1',3,'match3-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>            for (int f = i; f &lt; j; f+=K-1)
              for (int g = f+1; g &lt; j; g+=K-1)
                for (int h = g+1; h &lt; j; h+=K-1)
                  for (int p = h+1; p &lt; j; p+=K-1)
                    s[i][j] = min(s[i][j], s[i][f]+s[f+1][g]+s[g+1][h]+s[h+1][p]+s[p+1][j] + sum[j+1]-sum[i]);</B></FONT>
      return s[0][n-1];
    }

    REP(i, n)
      this-&gt;a[i] = a[i];
    this-&gt;K = K;
    return dfs(n);
  }
};

</PRE>
</BODY>
</HTML>
