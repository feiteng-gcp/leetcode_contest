<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>78_chsqaq.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>78_chsqaq.cpp</CENTER></H3><HR>
<PRE>
class Solution {
public:
    int mergeStones(vector&lt;int&gt;&amp; stones, int K) {
    const int N = 32;
    int dp[N][N][N], sum[N][N];
    int n = stones.size();
    if ((n - 1) % (K - 1) != 0) return -1;
    for (int i = 0; i &lt; N; i++) {
        for (int j = 0; j &lt; N; j++) {
            fill_n(dp[i][j], N, INT_MAX);
        }
    }

    for (int i = 0; i &lt; n; i++) {
        dp[i][i][1] = 0;
    }
    for (int i = 0; i &lt; n; i++) {
        sum[i][i] = stones[i];
    }
    for (int l = 0; l &lt; n; l++) {
        for (int r = l + 1; r &lt; n; r++) {
            sum[l][r] = sum[l][r - 1] + sum[r][r];
<A NAME="0"></A>        }
    }
    
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match21-1.html#0',3,'match21-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>    for (int len = 2; len &lt;= n; len++) {
        for (int l = 0; l &lt; n; l++) {
            int r = l + len - 1;
<A NAME="1"></A>            if (r &gt;= n) break;</B></FONT>
            for (int k = len; k &gt;= 1; k -= (K - 1)) {
                if (k &gt; K) continue;
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match21-1.html#1',3,'match21-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>                int &amp;d = dp[l][r][k];
                for (int m = l; m &lt; r; m++) {
                    for (int kl = m - l + 1; kl &gt;= 1; kl -= (K - 1)) {
                        if (dp[l][m][kl] == INT_MAX) continue;</B></FONT>
                        if (k - kl &lt; 1 || dp[m + 1][r][k - kl] == INT_MAX) continue;
                        d = min(d, dp[l][m][kl] + dp[m + 1][r][k - kl]);
                    }
                }
            }
            if (dp[l][r][K] != INT_MAX)
                dp[l][r][1] = min(dp[l][r][1], dp[l][r][K] + sum[l][r]);
        }
    }
    
    return dp[0][n - 1][1];
}
};
</PRE>
</BODY>
</HTML>
