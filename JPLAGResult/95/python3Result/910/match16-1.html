<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>153_lihuoran.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>153_lihuoran.py</CENTER></H3><HR>
<PRE>
class Solution:
	def gcd(self, a, b):
		if a &gt; b:
			return self.gcd(b, a)
		if a == 0:
			return b
		else:
			return self.gcd(b % a, a)

	def fast(self, a, n):
		# print(a, n)
		if n == 0:
			return 0
		if n &lt;= 20000:
			ret = 0
			for _ in range(n):
				ret += a
				ret %= 10 ** 9 + 7
			return ret
		else:
			val = 0
			for _ in range(10000):
				val += a
				val %= 10 ** 9 + 7
			ret = 0
			for _ in range(n // 10000):
				ret += val
				ret %= 10 ** 9 + 7
			for _ in range(n % 10000):
				ret += a
				ret %= 10 ** 9 + 7
			return ret



	def nthMagicalNumber(self, N, A, B):
		&quot;&quot;&quot;
		:type N: int
		:type A: int
		:type B: int
		:rtype: int
		&quot;&quot;&quot;
		if A == B:
			return self.fast(A, N)

		a = min(A, B)
		b = max(A, B)
		if b % a == 0:
			return self.fast(a, N)

		n = N - 1
		g = self.gcd(a, b)
		G = a * b // g
		cnt = G // a + G // b - 1

		p = n // cnt
		q = n % cnt		
<A NAME="0"></A>		# print(p, q)

		s = set([])
		<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match16-0.html#0',2,'match16-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>for i in range(1, G // a + 1):
			s.add(a * i)
		for i in range(1, G // b + 1):
			s.add(b * i)
		s = sorted(list(</B></FONT>s))
		# print(s)

		return (self.fast(G, p) + s[q]) % (10 ** 9 + 7)













</PRE>

</BODY>
</HTML>
