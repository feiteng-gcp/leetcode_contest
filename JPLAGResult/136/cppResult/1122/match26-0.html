<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>85_darrenhp.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>85_darrenhp.cpp</CENTER></H3><HR>
<PRE>
class Solution {
public:
  //const int MOD = ;
  string solve(int L, string &amp;S) {
    //cout &lt;&lt; &quot;solve :&quot; &lt;&lt; L &lt;&lt; endl;
<A NAME="0"></A>    int N = S.size();
    vector&lt;long long&gt; H(N);
    unordered_map&lt;int, vector&lt;int&gt;&gt; M;
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match26-1.html#0',3,'match26-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>    long long T = 1;
    for (int i = 0; i &lt; L; i++) {
      H[0] = (H[0] * 33 + S[i])&amp;0xffffffff;
      T = (T * 33)&amp;0xffffffff;
    }
    M[H[0]].push_back(0);
    //cout &lt;&lt; T &lt;&lt; endl;
    //cout &lt;&lt; 0 &lt;&lt; &quot; &quot; &lt;&lt; H[0] &lt;&lt; endl;
    for (int i = 1; i + L &lt;= S.size(); i++) {
      H[i] = (H[i-1] * 33 + S[i + L - 1] - (S[i-1]*T)&amp;0xffffffff + (1l&lt;&lt;32)) &amp;0xffffffff;</B></FONT>
      //cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; H[i] &lt;&lt; endl;
      M[H[i]].push_back(i);
    }
    for (auto &amp;it: M) if (it.second.size() &gt;= 2) {
      auto &amp;v = it.second;
      for (int i = 0; i &lt; v.size(); i++) {
        for (int j = i + 1; j &lt; v.size(); j++) {
          int ti = v[i], tj = v[j];
         // cout &lt;&lt; &quot;check &quot; &lt;&lt; S.substr(ti, L) &lt;&lt; &quot; &quot; &lt;&lt; S.substr(tj, L) &lt;&lt; endl;
          if (S.substr(ti, L) == S.substr(tj, L)) return S.substr(ti, L);
        }
      }
    }
    return &quot;&quot;;
  }
  string longestDupSubstring(string S) {
    int lo = 1, hi = S.size() + 1;
    while (lo &lt; hi) {
      int mid = (lo + hi) / 2;
      string s = solve(mid, S);
      if (s != &quot;&quot;) lo = mid + 1;
      else hi = mid;
    }
    //cout &lt;&lt; &quot;DONE&quot; &lt;&lt; endl;
    return hi == 1?&quot;&quot;:solve(hi - 1, S);
  }
};
</PRE>
</BODY>
</HTML>
