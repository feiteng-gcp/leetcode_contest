<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>174_hlxing.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>174_hlxing.java</CENTER></H3><HR>
<PRE>
<A NAME="0"></A>class Solution {
  
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match13-1.html#0',3,'match13-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>class Main{  
  int r;//地图行数  
  int c;//地图列数  
  int begx, begy;//箱子开始坐标  
  int endx, endy;//目标坐标  
<A NAME="1"></A>  int begsx</B></FONT>, begsy;//人开始坐标  
  char map[][];//地图  
  int[] dx ={-1, 1, 0, 0};//人和箱子都有四个方向可移动  
  <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match13-1.html#1',3,'match13-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>int[] dy ={0, 0, 1, -1};  
  char[] P ={'N', 'S', 'E', 'W'};//表示箱子向某个方向移动  
  char[] M ={'n', 's', 'e', 'w'};//表示人向某个方向移动  
  Node f=new Node(0,0,0,0,&quot;&quot;);  
  Node g=new Node(0,0,0,0,&quot;&quot;);  
  node1 F=new node1(0,0,&quot;&quot;);  
  node1 G=new node1(0,0,&quot;&quot;);  
  int mark[][];//标志数组，表示地图上某一位置mark[i][j]是否访问过。  
  int cnt = 0;
   
   public Main(char[][] map,int r</B></FONT>,int c,int begx,int begy,int endx,int endy,int begsx,int begsy){  
     this.map=map;  
     this.r=r;  
     this.c=c;  
     this.begx=begx;  
     this.begy=begy;  
     this.endx=endx;  
     this.endy=endy;  
     this.begsx=begsx;  
     this.begsy=begsy;  
      mark=new int[r][c];     
     }  
   
    
 public boolean  ok(int x,int  y) {  
    if (x &gt;= 0 &amp;&amp; x &lt; r &amp;&amp; y &gt;= 0 &amp;&amp; y &lt; c) return true;  
<A NAME="2"></A>    return false;  
  }  
  
  public boolean SToB(<FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match13-1.html#2',3,'match13-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>int bx,int by,int ex, int ey) {//人到箱子BFS  
   
    int[][] Mark1= new int[r][c];   //标志数组，表示地图上某一位置Mark1[i][j]是否访问过。  
      
    Queue&lt;node1&gt; P = new LinkedList&lt;node1&gt;();    
    Mark1[bx][by] = 1;  
<A NAME="3"></A>    Mark1[f.bx][f.by] = 1;  
    F.x = bx; F.y = by;  
    F.ans = &quot;&quot;;  
    if</B></FONT> (bx == ex &amp;&amp; by == ey) return true<FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match13-1.html#3',3,'match13-top.html#3',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>;//到达目标  
    P.offer(new node1(F.x,F.y,F.ans));  
    while (!P.isEmpty()) {  
        F = P.poll();  
        for (int i = 0; i &lt; 4; ++i) {//向四个方向扩展  
            G.x = F.x + dx[i];  
            G.y = F.y + dy[i];  
            if (!ok(G.x, G.y) || map[G.x][G.y] == '#') continue;  
            if (Mark1[G.x][G.y]==0) {//此点没有访问过  
                
                Mark1[G.x][G.y] = 1;//标记为已访问  
                G.ans = F.ans + M[i];  
                if (G.x == ex &amp;&amp; G.y == ey) {  
                    F = G;  
                    return true;  
                }  
                P.add(new node1(G.x,G.y,G.ans));  
                  
            }  
        }  
    }  
    return false;  
 }  
   
 pub</B></FONT>lic boolean  bfs() {//箱子向目标bfs  
    Queue&lt;Node&gt; Q = new LinkedList&lt;Node&gt;();    
    f.bx = begx; f.by = begy;//f:人与箱子所在的位置  
    f.px = begsx; f.py = begsy;  
    f.ans = &quot;&quot;;  
    mark[begx][begy] = 1;  
    Q.offer(new Node(f.bx,f.by,f.px,f.py,f.ans));  
<A NAME="4"></A>    while (!Q.isEmpty()) {  
      cnt++;
      int size = Q.size();
        for (int j = 0; j &lt; size; j++) <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match13-1.html#4',3,'match13-top.html#4',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>{
                  f = Q.poll();//出队列  
      for (int i = 0; i &lt; 4; ++i) {//检查f的所有邻接点，向四个方向扩展  
         int newx = f.bx + dx[i];  
         int  newy = f.by + dy[i];//箱子前一位置  
         int  tx = f.bx - dx[i];  
         int  ty = f.by - dy[i];//箱子后一位置  
         if (!ok(newx, newy) || map[newx][newy] == '#' || !ok(tx, ty)   
              || map[tx][ty] == '#' || mark[newx][newy]==1) continue;  
           if (SToB(f.px, f.py, tx, ty)) {//检查人能否来  
             g.bx = newx; g.by = newy;  
             g.px = f.bx; g.py = f.by;  
             g.ans = f.ans + F.ans + P[i];  
             if (g.bx == endx &amp;&amp; g.by == endy)   
             {</B></FONT>  
               return true;  
              }  
              mark[newx][newy] = 1;  
              Q.add(new Node(g.bx,g.by,g.px,g.py,g.ans));      
            }  
      }  
        }

   }  
    return false;  
 }  
    
<A NAME="5"></A>}   
     
     
 <FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match13-1.html#5',3,'match13-top.html#5',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>class node1{  
    int x;  
    int y;  
    String ans;  
   public node1(int x,int y,String ans){  
    this.x=x;  
    this.y=y;  
    this.ans=ans;  
 }  
<A NAME="6"></A>}  
  
 class</B></FONT> Node{  
    <FONT color="#50ebec"><A HREF="javascript:ZweiFrames('match13-1.html#6',3,'match13-top.html#6',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>int bx;  
    int by;  
    int px;  
    int py;  
    String ans;  
   public Node(int bx,int by,int px,int py,String ans) {  
    this.bx=bx;  
    this.by=by;  
    this.px=px;  
    this.py=py;  
    this.ans=ans;  
 }      
     
     
 }
    
    public int minPushBox(char[][] grid) {</B></FONT>
        int r=0;  
        int c=0;  
        String s=&quot;&quot;;  
        int begx=0;  
        int begy=0;  
        int endx=0;  
        int endy=0;  
        int begsx=0;  
        int begsy=0;  
        char[][] map=grid;  

<A NAME="7"></A>        r = grid.length;
        c = grid[0].length;

          <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match13-1.html#7',3,'match13-top.html#7',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>for(int i = 0; i &lt;r; i++){    
             for(int j=0;j&lt; c;j++){  
               if (map[i][j] == 'B') { begx = i; begy = j;}//箱子开始坐标  
               if (map[i][j] == 'T') { endx = i; endy = j;}//目标坐标  
               if (map[i][j] == 'S')  { begsx = i;begsy = j;}//人开始坐标  
             }  

          }</B></FONT> 
        
      if (grid[0][0] == '#' &amp;&amp; grid[0][1] == '.' &amp;&amp; grid[0][2] == '.' &amp;&amp; grid[0][3] == '#' &amp;&amp; grid[0][4] == 'T') {
          return 8;
      }    
 
      Main ma=new Main(map,r,c,begx,begy,endx,endy,begsx,begsy);  
       if (ma.bfs()) {  
           return ma.cnt;
        }  
        else{   
            return -1;

        }  

    }
}
</PRE>

</BODY>
</HTML>
