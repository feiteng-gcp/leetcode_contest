<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>9_SaveVMK.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>9_SaveVMK.java</CENTER></H3><HR>
<PRE>
<A NAME="0"></A>class Solution {
    public int minPushBox(char[][] grid) {
        <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match29-1.html#0',3,'match29-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>int n = grid.length;
        int m = grid[0].length;
        int ploc = 0;
        int bloc = 0;
        int tloc = 0;
        for (int i = 0; i &lt; n; ++i) {
            for (int j = 0; j &lt; m; ++j) {</B></FONT>
                if (grid[i][j]=='S') {
                    ploc = i*m+j;
                    grid[i][j] = '.';
                }
                if (grid[i][j]=='B') {
<A NAME="1"></A>                    bloc = i*m+j;
                    grid[i][j] = '.';
                }
                if (grid[i][j]=='T') <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match29-1.html#1',3,'match29-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>{
                    tloc = i*m+j;
                    grid[i][j] = '.';
                }
<A NAME="2"></A>            }
        }</B></FONT>
        ArrayList&lt;ArrayList&lt;Integer&gt;&gt; g = new ArrayList&lt;&gt;();
        <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match29-1.html#2',3,'match29-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>for (int px = 0; px &lt; n; ++px) {
            for (int py = 0; py &lt; m; ++py) {
                for (int bx = 0; bx &lt; n; ++bx) {
                    for (int by = 0</B></FONT>; by &lt; m; ++by) {
                        g.add(new ArrayList&lt;&gt;());
                    }
                }
            }
        }
        for (int bx = 0; bx &lt; n; ++bx) {
            for (int by = 0; by &lt; m; ++by) {
                if (grid[bx][by]=='#')
                    continue;
                if (bx&gt;0&amp;&amp;bx&lt;n-1&amp;&amp;grid[bx-1][by]=='.'&amp;&amp;grid[bx+1][by]=='.') {
                    int px = bx-1;
                    int py = by;
                    g.get(px*m*n*m+py*n*m+bx*m+by).add(bx*m*n*m+by*n*m+(bx+1)*m+by);
                    px = bx+1;
                    g.get(px*m*n*m+py*n*m+bx*m+by).add(bx*m*n*m+by*n*m+(bx-1)*m+by);
                }
                if (by&gt;0&amp;&amp;by&lt;m-1&amp;&amp;grid[bx][by-1]=='.'&amp;&amp;grid[bx][by+1]=='.') {
                    int px = bx;
                    int py = by-1;
                    g.get(px*m*n*m+py*n*m+bx*m+by).add(bx*m*n*m+by*n*m+bx*m+(by+1));
<A NAME="3"></A>                    py = by+1;
                    g.get(px*m*n*m+py*n*m+bx*m+by).add(bx*m*n*m+by*n*m+bx*m+(by-1));
                }
            <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match29-1.html#3',3,'match29-top.html#3',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        }
        for (int px = 0; px &lt; n; ++px) {
            for (int py = 0; py &lt; m; ++py) {
                for (int bx = 0; bx &lt; n; ++bx) {
                    for (int by = 0; by &lt; m; ++by) {
                        if</B></FONT> (grid[bx][by]=='#')
                            continue;
                        if (grid[px][py]=='#')
<A NAME="4"></A>                            continue;
                        int[] ox = {-1, 0, 1, 0};
                        int[] oy = {0, -1, 0, 1};
                        <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match29-1.html#4',3,'match29-top.html#4',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>for (int i = 0; i &lt; 4; ++i) {
                            int npx = px+ox[i];
                            int npy = py+oy[i];
                            if (npx==bx&amp;&amp;npy==by)
                                continue;
                            if</B></FONT> (npx&lt;0||npy&lt;0||npx&gt;=n||npy&gt;=m)
                                continue;
                            if (grid[npx][npy]=='#')
                                continue;
                            g.get(px*m*n*m+py*n*m+bx*m+by).add(npx*m*n*m+npy*n*m+bx*m+by);
                        }
                    }
                }
            }
        }
        int[] dists = new int[n*n*m*m];
        for (int i = 0; i &lt; n*n*m*m; ++i)
            dists[i] = 1000000000;
        int start = ploc*n*m+bloc;
        dists[start] = 0;
        ArrayDeque&lt;Integer&gt; q = new ArrayDeque&lt;&gt;();
        q.add(start);
        int ans = 1000000000;
        while (!q.isEmpty()) {
            int u = q.removeFirst();
            int d = dists[u];
            if (u%(n*m)==tloc)
                ans = Math.min(d, ans);
            for (int v : g.get(u)) {
                int box = (v%(n*m)==u%(n*m))?0:1;
                if (d+box&lt;dists[v]) {
                    dists[v] = d+box;
                    q.add(v);
                }
            }
        }
        return ans &gt; 1000000 ? -1 : ans;
    }
}
</PRE>

</BODY>
</HTML>
