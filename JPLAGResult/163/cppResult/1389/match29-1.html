<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>15_perfectpan.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>15_perfectpan.cpp</CENTER></H3><HR>
<PRE>
<A NAME="2"></A>class Solution {
public:
    int n,m,ri,rj,di,dj,bi,bj;
<FONT color="#77bfc7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match29-0.html#2',2,'match29-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>    int dir[4][2] = { { -1, 0 }, { 0, 1 }, { 0, -1 }, { 1, 0 } };
    int mp[30][30];</B></FONT>
    int vir[30][30][30][30];
    struct node{
        int bx, by;
        int rx, ry;
        int cnt;
    };
    struct man{
        int x, y;
    };
    bool check(int i, int j){
        if (i&lt;1 || i&gt;m || j&lt;1 || j&gt;n || mp[i][j] == '#')
            return 0;
        return 1;
    }
    int bfs2(int si, int sj, int di, int dj, int bi, int bj)
    {
        int vis[30][30];
        memset(vis, 0, sizeof(vis));
        queue&lt;man&gt;qu;
        man st, ed;
        st.x = si;
        st.y = sj;
        vis[si][sj] = 1;
        qu.push(st);
        while (!qu.empty()){
            st = qu.front();
            qu.pop();
            if (st.x == di&amp;&amp;st.y == dj)
                return 1;
            for (int i = 0; i &lt; 4; i++){
                ed.x = st.x + dir[i][0];
                ed.y = st.y + dir[i][1];
                if (check(ed.x, ed.y)&amp;&amp; !vis[ed.x][ed.y]&amp;&amp; (ed.x != bi||ed.y != bj)){
                    vis[ed.x][ed.y] = 1;
                    qu.push(ed);
                }
            }
        }
        return 0;
    }

    int bfs(int bi, int bj, int ri, int rj, int di, int dj){
        queue&lt;node&gt;q;
        node f, d;
        f.bx = bi;
        f.by = bj;
        f.rx = ri;
        f.ry = rj;
        f.cnt = 0;
        vir[bi][bj][ri][rj] = 1;
        q.push(f);
        while (!q.empty()){
            f = q.front();
            q.pop();
            if (f.bx == di&amp;&amp;f.by == dj)
                return f.cnt;
            for (int i = 0; i&lt;4; i++){
                d.bx = f.bx + dir[i][0];
                d.by = f.by + dir[i][1];
                d.rx = f.bx - dir[i][0];
                d.ry = f.by - dir[i][1];
                if (check(d.bx, d.by)&amp;&amp;check(d.rx,d.ry) &amp;&amp; !vir[d.bx][d.by][d.rx][d.ry]){
                    if (bfs2(f.rx, f.ry, d.rx, d.ry, f.bx, f.by)){
                        vir[d.bx][d.by][d.rx][d.ry] = 1;
                        d.cnt = f.cnt + 1;
                        q.push(d);
                    }
                }
            }
        }
<A NAME="0"></A>        return -1;
    }
    int minPushBox(vector&lt;vector&lt;char&gt;&gt;&amp; grid) {
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match29-0.html#0',2,'match29-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>        m=(int)grid.size(),n=(int)grid[0].size();
<A NAME="1"></A>        for (int i=1;i&lt;=m;i++){
            for (int j=1;j&lt;=n;j++){</B></FONT>
                mp[i][j]=grid[i-1][j-1];
<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match29-0.html#1',2,'match29-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>                if (mp[i][j]=='S'){
                    ri=i;
                    rj=j;
                }
                if (mp[i][j]=='B'){
                    bi=i;
                    bj=j;
                }
                if (mp[i][j]=='T'){
                    di=i;
                    dj=j;
                }
            }
        }
        int ans=bfs(bi,bj,ri,rj,di,dj);</B></FONT>
        return ans;   
    }
};
</PRE>
</BODY>
</HTML>
