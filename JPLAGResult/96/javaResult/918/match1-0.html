<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>28_ZihanWang98.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>28_ZihanWang98.java</CENTER></H3><HR>
<PRE>
class Solution {
    public static class DirEdge {
            int a, b, c;
            int reachFromA;

            public DirEdge(int a, int b, int c) {
                this.a = a;
                this.b = b;
                this.c = c;
            }
        }

        public static class LinkEdge {
            int val;
            DirEdge dirEdge;

            public LinkEdge(int val, DirEdge dirEdge) {
                this.val = val;
                this.dirEdge = dirEdge;
            }
        }

        List&lt;DirEdge&gt;[] nodes;
        public int reachableNodes(int[][] edges, int M, int N) {
            int l = edges.length;
            nodes = new List[N];
            for (int i = 0; i &lt; N; i++) {
                nodes[i] = new ArrayList&lt;&gt;();
            }
            for (int i = 0; i &lt; l; i++) {
                int a = edges[i][0];
                int b = edges[i][1];
                int c = edges[i][2];
                nodes[a].add(new DirEdge(a, b, c));
                nodes[b].add(new DirEdge(b, a, c));
            }
            boolean[] visit = new boolean[N];
            int[] dist = new int[N];
            Arrays.fill(dist, Integer.MAX_VALUE / 2);
            PriorityQueue&lt;LinkEdge&gt; pq = new PriorityQueue&lt;&gt;(new Comparator&lt;LinkEdge&gt;() {
                @Override
                public int compare(LinkEdge linkEdge, LinkEdge t1) {
                    return Integer.compare(linkEdge.val, t1.val);
                }
            });
            visit[0] = true;
            dist[0] = 0;
            for (int i = 0; i &lt; nodes[0].size(); i++) {
                pq.add(new LinkEdge(nodes[0].get(i).c + 1, nodes[0].get(i)));
            }
            while (!pq.isEmpty()) {
                LinkEdge lk = pq.poll();
                int y = M - dist[lk.dirEdge.a];
                lk.dirEdge.reachFromA = Math.max(lk.dirEdge.reachFromA, y);
                if (visit[lk.dirEdge.b]) {
                    assert lk.val &gt;= dist[lk.dirEdge.b];
                } else {
                    if (y &gt;= lk.dirEdge.c + 1) {
                        visit[lk.dirEdge.b] = true;
                        dist[lk.dirEdge.b] = lk.val;
                        for (int i = 0; i &lt; nodes[lk.dirEdge.b].size(); i++) {
                            DirEdge dr = nodes[lk.dirEdge.b].get(i);
                            pq.add(new LinkEdge(dr.c + lk.val + 1, dr));
                        }
                    }
                }
            }
            long vist = 0;
            Map&lt;Integer, Integer&gt;[] mu = new Map[N];
            for (int i = 0; i &lt; N; i++) {
                mu[i] = new HashMap&lt;&gt;();
            }
            for (int i = 0; i &lt; N; i++) {
                for (int j = 0; j &lt; nodes[i].size(); j++) {
                    DirEdge dr = nodes[i].get(j);
                    if (mu[dr.b].containsKey(dr.a)) {
                        int rb = mu[dr.b].get(dr.a);
                        int ra = dr.reachFromA;
                        vist += Math.min(rb + ra, dr.c);
                    } else {
                        mu[dr.a].put(dr.b, dr.reachFromA);
<A NAME="0"></A>                    }
                }
            }
            <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match1-1.html#0',3,'match1-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>for (int i = 0; i &lt; N; i++) {
                if (visit[i]) {
                    vist ++;
                }
            }</B></FONT>
            return (int) vist;

        }
}
</PRE>

</BODY>
</HTML>
