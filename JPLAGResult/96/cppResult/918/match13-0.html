<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>6_cai_lw.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>6_cai_lw.cpp</CENTER></H3><HR>
<PRE>
const int INF=1111111111;

struct Rec{
<A NAME="0"></A>    int i;
    int d;
    Rec(){}
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match13-1.html#0',3,'match13-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>    Rec(int i,int d):i(i),d(d){}
    bool operator&lt;(const Rec&amp; other) const {
        return d&gt;other.d;
    }
};

class Solution {</B></FONT>
    vector&lt;vector&lt;pair&lt;int,int&gt;&gt;&gt; edg;
    int n;
    vector&lt;int&gt; dijkstra(){
        vector&lt;int&gt; dis(n,INF);
        vector&lt;bool&gt; fix(n);
        priority_queue&lt;Rec&gt; pq;
        dis[0]=0;
        pq.push(Rec(0,0));
        while(!pq.empty()){
            int u=pq.top().i;
            pq.pop();
            if(fix[u])continue;
            fix[u]=true;
            for(auto p:edg[u]){
                int v=p.first,w=p.second;
                if(dis[u]+w&lt;dis[v]){
                    dis[v]=dis[u]+w;
                    pq.push(Rec(v,dis[v]));
                }
            }
        }
        return dis;
    }
public:
    int reachableNodes(vector&lt;vector&lt;int&gt;&gt;&amp; edges, int M, int N) {
        n=N;
        edg=vector&lt;vector&lt;pair&lt;int,int&gt;&gt;&gt;(n);
        for(auto &amp;e:edges){
            edg[e[0]].push_back({e[1],e[2]+1});
            edg[e[1]].push_back({e[0],e[2]+1});
        }
        auto dis=dijkstra();
        int ans=0;
        for(int i=0;i&lt;n;i++)
            if(dis[i]&lt;=M)ans++;
        for(auto &amp;e:edges){
            int l=M-dis[e[0]],r=M-dis[e[1]];
            ans+=min(e[2],max(l,0)+max(r,0));
        }
        return ans;
    }
};
</PRE>
</BODY>
</HTML>
