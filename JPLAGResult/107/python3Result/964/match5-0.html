<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>418_luxy622.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>418_luxy622.py</CENTER></H3><HR>
<PRE>
class Solution:
    def minMalwareSpread(self, graph, initial):
        
        if not graph or not initial: return 0
<A NAME="0"></A>        initial = sorted(initial)
        
        N = len(graph)
        G = collections.defaultdict<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match5-1.html#0',3,'match5-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>(set)
        for i in range(N):
            for j in range(N):
                if graph[i][j] == 1:
                    G[i].add(j) 
                    G[j].add(i)</B></FONT> 
        I = set(initial)
        #print(G)
        
        def find(i, par):
            if par[i] &lt; 0:
                return i
            par[i] = find(par[i], par)
            return par[i]
        
        def merge(i, j, par):
            pi, pj = find(i, par), find(j, par)
            if pi == pj: return
            if par[pi] &lt; par[pj]:
                pi, pj = pj, pi
            par[pj] += par[pi]
            par[pi] = pj
        
        par = [-1] * N
        for i in range(N):
            if i not in I:
                for j in G[i]:
                    if j not in I:
                        merge(i, j, par)
        #print(par)
        
        B = collections.defaultdict(set)
        for i in I:
            for j in G[i]:
                if j not in I:
                    pj = find(j, par)
                    B[pj].add(i)
        
        #print(B)
        
        W = 0
        res = -1
        for i in initial:
            tmp = 0
            if not G[i]: continue
            #print(i, set([find(j, par) for j in G[i]]))
            for pj in set([find(j, par) for j in G[i]]):
                if pj not in I and len(B[pj]) == 1:
                    tmp -= par[pj]
                    #print(pj, -par[pj])
            if tmp &gt; W:
                W = tmp
                res = i
        return res if res != -1 else initial[0]
                    
</PRE>

</BODY>
</HTML>
