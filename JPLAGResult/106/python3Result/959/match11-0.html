<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>456_wuanqi.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>456_wuanqi.py</CENTER></H3><HR>
<PRE>
class Solution:
    def threeSumMulti(self, A, target):
        &quot;&quot;&quot;
        :type A: List[int]
        :type target: int
        :rtype: int
        &quot;&quot;&quot;
        MOD = 10**9 + 7
        A = sorted(A)
        ans = 0
        c = collections.Counter(A)
        S = set(c)
        
        q = collections.deque()
        for s in S:
            if s &lt;= target:
                q.append([[s], 1, s])
        
        while q:
            l, size, Sum = q.popleft()
            if size == 3:
                if Sum == target:
                    ans += c[l[0]]*c[l[1]]*c[l[2]]
            elif size &lt; 3:
                for s in S:
                    if s &gt; l[-1] and Sum + s &lt;= target:
<A NAME="0"></A>                        q.append([l + [s], size + 1, Sum + s])
        
        for s in S:
            <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match11-1.html#0',3,'match11-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if 3*s == target and c[s] &gt;= 3:
                ans += c[s]*(c[s] - 1)*(c[s] - 2) // 6 
            if c[s] &gt;= 2 and target - 2*s in S and target - 2*s != s:
                ans += c[target - 2*s]*c[s]*(c[</B></FONT>s] - 1) // 2
        return ans % MOD
</PRE>

</BODY>
</HTML>
