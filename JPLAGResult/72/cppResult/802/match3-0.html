<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>46_cchao.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>46_cchao.cpp</CENTER></H3><HR>
<PRE>
#include &lt;bits/stdc++.h&gt;
using namespace std;
#define REP(i, n) for (int i = 0; i &lt; int(n); ++i)
#define REPE(i, a, b) for (int i = (a); i &lt;= int(b); ++i)
#define SZ(x) ((int)(x).size())
#define ALL(x) x.begin(), x.end()
#define PB push_back
#define EB emplace_back
using LL = long long;
using PII = pair&lt;int, int&gt;;
#define F first
#define S second
void R(int &amp;x) { scanf(&quot;%d&quot;, &amp;x); }
void R(LL &amp;x) { scanf(&quot;%lld&quot;, &amp;x); }
void R(double &amp;x) { scanf(&quot;%lf&quot;, &amp;x); }
template &lt;typename T&gt; void R(T &amp;t) { cin &gt;&gt; t; }
template &lt;typename T&gt; void R(vector&lt;T&gt; &amp;ar) {
  for (auto &amp;it : ar)
    R(it);
}
template &lt;typename T, typename... Args&gt; void R(T &amp;t, Args &amp;... args) {
  R(t);
  R(args...);
}
<A NAME="0"></A>
using T = pair&lt;vector&lt;int&gt;::iterator, vector&lt;int&gt;::reverse_iterator&gt;;
struct cmp {
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match3-1.html#0',3,'match3-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>  bool operator()(const T &amp;a, const T &amp;b) {
    return *a.F * *b.S &gt; *b.F * *a.S;
  }
};
bool v[2020][2020];
class Solution {
public:
    vector&lt;int&gt; kthSmallestPrimeFraction(vector&lt;int&gt;&amp; A, int K) {</B></FONT>
        priority_queue&lt;T, vector&lt;T&gt;, cmp&gt; q;
        q.emplace(A.begin(), A.rbegin());
        memset(v, 0, sizeof v);
        v[0][0] = true;
        while (K--) {
            auto x = q.top();
            q.pop();
            if (K == 0) return {*x.F, *x.S};
            x.F++;
            if (x.F != A.end()) {
                int i = x.F - A.begin();
                int j = x.S - A.rbegin();
                if (!v[i][j]) {
                    q.push(x);
                    v[i][j] = true;
                }
            }
            x.F--;
            x.S++;
            if (x.S != A.rend()) {
                int i = x.F - A.begin();
                int j = x.S - A.rbegin();
                if (!v[i][j]) {
                    q.push(x);
                    v[i][j] = true;
                }
            }
            x.S--;
        }
    }
};
</PRE>
</BODY>
</HTML>
