<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>458_wangpandada.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>458_wangpandada.java</CENTER></H3><HR>
<PRE>
class Solution {
<A NAME="0"></A>    int[][] targetLoc;
<A NAME="1"></A>    
    public int minimumMoves(int[][] grid) {
        targetLoc = <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match21-1.html#0',3,'match21-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>new int[][] { {grid.length - 1, grid.length - 2}, {grid.length - 1, grid.length - 1}</B></FONT> };
        <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match21-1.html#1',3,'match21-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>int[][] snake = { {0, 0}, {0, 1} };
        Queue&lt;int[][]&gt; queue = new ArrayDeque&lt;&gt;()</B></FONT>;
        Queue&lt;Integer&gt; steps = new ArrayDeque&lt;&gt;();
        queue.offer(snake);
        steps.offer(0);
        
        int minSteps = -1;
        Set&lt;String&gt; seen = new HashSet&lt;&gt;();

        while (!queue.isEmpty()) {
            int[][] curSnake = queue.poll();
            int curStep = steps.poll();
            if (reachEnd(curSnake)) {
                minSteps = curStep;
                break;
            }
            String hash = hashSnake(curSnake);
            //System.out.println(hash);
            if (seen.contains(hash)) {
                continue;
            }
            seen.add(hash);
            
            for (int[][] nextSnake : nextSnakes(grid, curSnake)) {
                queue.offer(nextSnake);
                steps.offer(curStep + 1);
            }
        }
        return minSteps;
    }
    
    private String hashSnake(int[][] snake) {
        return snake[0][0] + &quot;,&quot; + snake[0][1] + &quot;,&quot; + snake[1][0] + &quot;,&quot; + snake[1][1];
    }
    
    private boolean reachEnd(int[][] snake) {
        if (snake[0][0] == targetLoc[0][0] &amp;&amp; snake[0][1] == targetLoc[0][1]) {
            if (snake[1][0] == targetLoc[1][0] &amp;&amp; snake[1][1] == targetLoc[1][1]) {
                return true;
            }
        }
        return false;
    }
    
    private List&lt;int[][]&gt; nextSnakes(int[][] grid, int[][] snake) {
<A NAME="2"></A>        List&lt;int[][]&gt; res = new ArrayList&lt;&gt;();
        if (snake[0][1] + 1 &lt; grid[0].length &amp;&amp; snake[1][1] + 1 &lt; grid[0].length) {
<A NAME="3"></A>            if (grid[snake[0][0]][snake[0][1] + 1] == 0 &amp;&amp; grid[snake[1][0]][snake[1][1] + 1] == 0) {
                <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match21-1.html#2',3,'match21-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>res.add(new int[][] {{snake[0][0], snake[0][1] + 1}, {snake[1][0], snake[1][1] + 1}</B></FONT>});
                if (snake[0][1] == snake[1][1]) {
                    <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match21-1.html#3',3,'match21-top.html#3',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>res.add(new int[][] {{snake[0][0], snake[0][1]}, {snake[0][0], snake[0][1] + 1}});
                }
            }
<A NAME="4"></A>        }</B></FONT>
        if (snake[0][0] + 1 &lt; grid.length &amp;&amp; snake[1][0] + 1 &lt; grid.length) {
<A NAME="5"></A>            if (grid[snake[0][0] + 1][snake[0][1]] == 0 &amp;&amp; grid[snake[1][0] + 1][snake[1][1]] == 0) {
                <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match21-1.html#4',3,'match21-top.html#4',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>res.add(new int[][] {{snake[0][0] + 1, snake[0][1]}, {snake[1][0] + 1, snake[1][1]}</B></FONT>});
                if (snake[0][0] == snake[1][0]) {
                    <FONT color="#c8c2a7"><A HREF="javascript:ZweiFrames('match21-1.html#5',3,'match21-top.html#5',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>res.add(new int[][] {{snake[0][0], snake[0][1]}, {snake[0][0] + 1, snake[0][1]}});
                }
            }
        }</B></FONT>

        return res;
    }
    
    // private boolean validSnake(int[][] grid, int[][] snake) {
    //     for (int i = 0; i &lt; snake.length; i++) {
    //         for (int j = 0; j &lt; snake[0].length; j++) {
    //             if (snake[i][j] &lt; 0 || snake[i][j] &gt;= grid.length) {
    //                 return false;
    //             }
    //             if (snake[i][j] &lt; 0 || snake[i][j] &gt;= grid[0].length) {
    //                 return false;
    //             }
    //         }
    //     }
    //     return true;
    // }
}
</PRE>

</BODY>
</HTML>
