<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>41_raft.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>41_raft.java</CENTER></H3><HR>
<PRE>
class Solution {
    int[] sz;
    int[] par;
    int n;
    final int M = 100001;
    int[] fac = new int[M];
    int maxSz = 0;
    
    public int largestComponentSize(int[] A) {
        for (int i = 1; i &lt; M; i++) fac[i] = i;
        for (int i = 2; i &lt; M / i; i++) {
            if (fac[i] == i) {
                for (int j = i * i; j &lt; M; j += i)
                    fac[j] = i;
<A NAME="0"></A>            }
        }
        
        <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match9-1.html#0',3,'match9-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>n = A.length;
        sz = new int[M];
        par = new int[M];
        for (int i = 2; i &lt; M; i++) {
            p</B></FONT>ar[i] = i;
        }
        for (int v : A) {
            sz[v]++;
        }
        
        for (int i = 2; i &lt; M; i++) {
            if (sz[i] == 0) continue;
            int q = i;
            int ii = i;
            while (ii &gt; 1) {
                //System.out.println(&quot;i = &quot; + ii + &quot;, p = &quot; + fac[ii]);
                int p = fac[ii];
                add(p, q);
                ii/= p;
            }
        }
        return maxSz;
    }
    
    private int find(int p) {
        int r = p;
        while (par[r] != r) r = par[r];
        
        while (p != r) {
<A NAME="1"></A>            int t = par[p];
            par[p] = r;
            p = t;
        <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match9-1.html#1',3,'match9-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        return r;
    }
    
    private void add(int p, int q) {
        int rp = find(p);
        int rq = find(q);
        if (rp == rq) return;</B></FONT>
        
        int st = sz[rp] + sz[rq];
        if (sz[rp] &lt; sz[rq]) {
            par[rp] = rq;
            sz[rq] = st;
        }else {
            par[rq] = rp;
            sz[rp] = st;
        }
        
        if (maxSz &lt; st) maxSz = st;
    }
    
}
</PRE>

</BODY>
</HTML>
