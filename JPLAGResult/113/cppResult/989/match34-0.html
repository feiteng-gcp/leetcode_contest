<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>112_zljiuyouuu.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>112_zljiuyouuu.cpp</CENTER></H3><HR>
<PRE>
class Solution {
<A NAME="0"></A> private:
  int result_;
  vector&lt;int&gt; father_;
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match34-1.html#0',3,'match34-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>  vector&lt;int&gt; size_;

  int find(int index){
    if (father_[index] == -1) return index;
     // cout&lt;&lt;index&lt;&lt;&quot; &quot;&lt;&lt; father_[index]&lt;&lt;endl;
    return father_[index] = find(father_[index]);
  }

  void union_set(int i, int j){</B></FONT>
    int x = find(i);
    int y = find(j);
    if (x == y) return;
    if (y &gt; x) swap(x, y);
    size_[x] += size_[y];
    result_ = max(result_, size_[x]);
    father_[y] = x;
  }
 public:
  int largestComponentSize(vector&lt;int&gt;&amp; A) {
    vector&lt;int&gt; primes(1, 2);
    int max_number = 0;
    for (int i : A) max_number = max(i, max_number);
    if (max_number &lt; 2) return 0;
    max_number++;
    vector&lt;bool&gt; passed(max_number, false);
    int upper = sqrt(max_number);
    for (int i=3; i&lt;max_number; i+=2) {
      if (!passed[i]) {
        primes.push_back(i);
        //avoid overflow
        if (i&gt;upper) continue;
        for (int j=i*i; j&lt;max_number; j+=i) {
          passed[j] = true;
        }
      }
    }

    father_.resize(primes.size(), -1);
    size_.resize(primes.size(), 0);
    result_ = 0;
    for (int k : A){
      int i = k;
      int f = -1;
      if (i == 1) {
          result_ = max(result_, 1);
          continue;
      }
      while(i &gt; 1){
        for (int j = 0; j &lt; primes.size(); j++){
          if (i % primes[j] == 0){
            while (i % primes[j] == 0) i /= primes[j];
            if (f == -1){
              f = j;
              size_[find(j)]++;
              result_ = max(size_[find(j)], result_);
            }else{
              union_set(f, j);
            }
          }
          if (i &lt; 2) break;
            //cout&lt;&lt;i&lt;&lt;endl;
        }
      }
    }
    return result_;
  }
};


</PRE>
</BODY>
</HTML>
