<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>38_biltharesatyendra.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>38_biltharesatyendra.cpp</CENTER></H3><HR>
<PRE>
int fa[200005];
vector&lt;int&gt; v[20005];
int sz[200005];
<A NAME="0"></A>int pr[100005];
vector&lt;int&gt; factors[100005];
vector&lt;int&gt; p;
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match32-1.html#0',3,'match32-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>int done;
int get(int m)
{
    if(fa[m]==m)return m;
    return fa[m] = get(fa[m]);
}
void unite(int x, int y)
{</B></FONT>
   // printf(&quot;uniting %d %d\n&quot;,x,y);
    x = get(x);
    y = get(y);
    if(x==y)return;
    if(sz[y] &gt; sz[x])swap(x,y);
    sz[x] += sz[y];
    fa[y] = x;
}
void process()
{
    if(done)return;
    done = 1;
    int n,m;
    int hi = 100000;
   // hi = 10;
   // printf(&quot;calculate\n&quot;);
    int cur = 0;
    for(n=2; n&lt;=hi; n++)
    {
        if(pr[n]==0)
        {
            p.push_back(n);
            for(m=n;m&lt;=hi;m+=n){
                pr[m] = 1;
                factors[m].push_back(cur);
                
            }
            cur++;
        }
    }
}
class Solution {
public:
    int largestComponentSize(vector&lt;int&gt;&amp; a) {
        process();
        int n = a.size();
        int i,j,x,y;
        for(i=1; i&lt;=n; i++)
        {
            fa[i] = i;
            sz[i] = 1;
        }
        printf(&quot;done %d\n&quot;,n);
      //  printf(&quot;total %d\n&quot;,p.size());
       // return 0;
        for(i=0;i&lt;n;i++)
        {
             x = a[i];
            for(j=0;j&lt;factors[x].size();j++)
            {
                y = factors[x][j];
                v[y].push_back(i+1);
            }
        }
        for(i=0;i&lt;p.size();i++)
        {
            int m = v[i].size();
          if(m &gt; 1)
          {
              for(j=0;j&lt;m-1;j++)
                  unite(v[i][j],v[i][j+1]);
          }
            v[i].clear();
        }
        int ans = 0;
        for(i=1; i&lt;=n; i++)
            ans = max(ans,sz[i]);
        return ans;
    }
};
</PRE>
</BODY>
</HTML>
