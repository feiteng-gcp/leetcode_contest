<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>56_liouzhou_101.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>56_liouzhou_101.cpp</CENTER></H3><HR>
<PRE>
const int MAXN = 200010;

int myflag;
vector&lt;int&gt; ff(MAXN);

class DinnerPlates {
public:
    int cap;
    vector&lt;vector&lt;int&gt;&gt; v;
    priority_queue&lt;int, vector&lt;int&gt;, greater&lt;int&gt; &gt; notfull;
    priority_queue&lt;int&gt; notempty;
    DinnerPlates(int capacity) {
        if (!myflag)
        {
            myflag = 1;
            for (int i = 0; i &lt; MAXN; ++ i)
                ff[i] = i;
        }
        cap = capacity;
        v.resize(MAXN);
        notfull = priority_queue&lt;int, vector&lt;int&gt;, greater&lt;int&gt; &gt;(ff.begin(), ff.end());
    }
    
    void push(int val) {
        int id = notfull.top();
        while (v[id].size() == cap)
        {
            notfull.pop();
            id = notfull.top();
        }
        v[id].push_back(val);
        if (v[id].size() == 1)
            notempty.push(id);
    }
    
    int pop() {
        if (notempty.empty()) return -1;
        int id = notempty.top();
        while (!notempty.empty())
<A NAME="0"></A>        {
            if (v[id].size() != 0) break;
            notempty.pop();
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match31-1.html#0',3,'match31-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>            id = notempty.top();
        }
        if (notempty.empty()) return -1;
        int ret = v[id].back();
        v[id].pop_back();
        if (v[id].size() == cap-1)
            notfull.push(id);
        return ret;
    }
    
    int popAtStack(int id) {
        if (v[id].empty()) return -1;
        int ret = v[id].back();
        v[id].pop_back();
        if (v[id].size() == cap-1)
            notfull.push(id);
        return ret;
    }
};</B></FONT>

/**
 * Your DinnerPlates object will be instantiated and called as such:
 * DinnerPlates* obj = new DinnerPlates(capacity);
 * obj-&gt;push(val);
 * int param_2 = obj-&gt;pop();
 * int param_3 = obj-&gt;popAtStack(index);
 */
</PRE>
</BODY>
</HTML>
