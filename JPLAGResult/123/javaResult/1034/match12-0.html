<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>53_xuan18.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>53_xuan18.java</CENTER></H3><HR>
<PRE>
class Solution {
    
    public class CountHelper {
        HashMap&lt;Integer, Integer&gt; countMap;
        int count;
        
        public CountHelper () {
            countMap = new HashMap&lt;&gt;();
            count = 0;
        }
        
        public void add(Integer v) {
            Integer c = countMap.get(v);
            if (c == null) {
                c = 0;
            }
            if (c.equals(0)) {
                count += 1;
            }
            countMap.put(v, c+1);
        }
        
        public void remove(Integer v) {
            Integer c = countMap.get(v);
            countMap.put(v, c-1);
            if (c.equals(1)) {
                count -= 1;
            }
        }
        
        public int countIfAdd(Integer v) {
            Integer c = countMap.get(v);
            if (c == null || c.equals(0)) {
                return count + 1;
            } else {
                return count;
            }
<A NAME="0"></A>        }
    }
    
    <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match12-1.html#0',3,'match12-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>public int subarraysWithKDistinct(int[] A, int K) {
        return getNumberOfSubArraysWithAtMostKDistinct(A, K) - getNumberOfSubArraysWithAtMostKDistinct(A, K-1);
    }
    
    private int getNumberOfSubArraysWithAtMostKDistinct(int[] A, int K) {</B></FONT>
        if (K &lt;= 0) {
            return 0;
        }
        
        CountHelper countHelper = new CountHelper();
        int n = A.length, i = 0, j = 0;
        int ret = 0;
        while (i &lt; n) {
            if (j == n) {
                ret += (j - i);
                countHelper.remove(A[i]); // not necessary though
                i += 1;
            } else if (countHelper.count &lt; K) {
                countHelper.add(A[j]);
                j += 1;
            } else if (countHelper.countIfAdd(A[j]) &lt;= K) {
                countHelper.add(A[j]);
                j += 1;
            } else {
                ret += (j - i);
                countHelper.remove(A[i]);
                i += 1;
            }
        }
        return ret;
    }
}
</PRE>

</BODY>
</HTML>
