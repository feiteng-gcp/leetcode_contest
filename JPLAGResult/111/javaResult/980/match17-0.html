<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>64_KakaHiguain.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>64_KakaHiguain.java</CENTER></H3><HR>
<PRE>
class Solution {
<A NAME="0"></A>    public String shortestSuperstring(String[] A) {
        int n=A.length;
        int sum=0;
        for (int i=0;i&lt;n;i++) sum+=A[i].length()<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match17-1.html#0',3,'match17-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>;
        int[][] f=new int[n][n];
        int[][] g=new int[1&lt;&lt;n][n];
        int[][][] h=new int[1&lt;&lt;n][n][2];
        for (int i=0;i</B></FONT>&lt;(1&lt;&lt;n);i++)
            for (int j=0;j&lt;n;j++)
                g[i][j]=-1;
        
        for (int i=0;i&lt;n;i++)
            for (int j=0;j&lt;n;j++)
                if (i!=j)
                {
                    int l1=A[i].length(),l2=A[j].length();
                    int l=Math.min(l1,l2);
                    for (int k=l-1;k&gt;=0;k--)
                    {
                        //System.out.println(i+&quot; &quot;+j+&quot; &quot;+f[i][j]);
                        if (A[i].substring(l1-k).equals(A[j].substring(0,k)))
                        {
                            f[i][j]=k;
                            break;
                        }
                    }
                }
        
        Queue&lt;int[]&gt; q=new ArrayDeque&lt;&gt;();
        for (int i=0;i&lt;n;i++) 
        {
<A NAME="1"></A>            q.offer(new int[]{1&lt;&lt;i,i});
            g[1&lt;&lt;i][i]=0;
            h[1&lt;&lt;i][i]=new int[]{-1,-1};
        <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match17-1.html#1',3,'match17-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        while (!q.isEmpty())
        {
            int[] now=q.poll();
            int state=now[0],</B></FONT>last=now[1];
            for (int i=0;i&lt;n;i++)
                if ((state&amp;(1&lt;&lt;i))==0)
                {
                    int state2=state|(1&lt;&lt;i);
                    if (g[state2][i]&lt;g[state][last]+f[last][i])
                    {
                        g[state2][i]=g[state][last]+f[last][i];
<A NAME="2"></A>                        h[state2][i]=new int[]{state,last};
                        q.offer(new int[]{state2,i});
                    }
                <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match17-1.html#2',3,'match17-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        }
        int ans=-1,ansi=-1;
        for (int i=0;i&lt;n;i++) 
        {
            if (ans&lt;=g[(1&lt;&lt;n)-1][i]) 
            {
                ans=g[(1&lt;&lt;n)-1][i];
                ansi=i;
            }
        }
        int state=(1&lt;&lt;n)-1,now=a</B></FONT>nsi;
        String s=A[now];
        while (now&gt;=0)
        {
            int last=h[state][now][1],state2=h[state][now][0];
            if (last==-1) break;
            //System.out.println(state+&quot; &quot;+now+&quot; &quot;+state2+&quot; &quot;+last);
            int overlap=f[last][now];
            s=A[last].substring(0,A[last].length()-overlap)+s;
            now=last;
            state=state2;
        }
        return s;
    }
}
</PRE>

</BODY>
</HTML>
