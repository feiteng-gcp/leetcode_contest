<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>32_QAMichaelPeng.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>32_QAMichaelPeng.java</CENTER></H3><HR>
<PRE>
class Solution {
         int[][] overlaps;
        String best=&quot;&quot;;
<A NAME="0"></A>        private int calc(String s1, String s2) {
            int d=Math.min(s1.length(), s2.length())-1;
            for (int k=d;k&gt;0;--k) {
                if (s1.substring(s1.length()-k).equals(s2.substring(0, k))) <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match28-0.html#0',2,'match28-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>{
                    return k;
                }
            }
            return 0;
        }
        void dfs(int[] perm</B></FONT>, int beg, int n, String[]A, int len) {
//            log.info(&quot;dfs beg: {}, len {}&quot;, beg, len);
            if (beg==n) {
                if (len&lt;best.length()) {
                    String tmp = A[perm[0]];
//                    log.info(&quot;tmp: {}&quot;, tmp);
                    for (int i = 1; i &lt; n; ++i) {
                        tmp = tmp + A[perm[i]].substring(overlaps[perm[i-1]][perm[i]]);
//                        log.info(&quot;tmp: {}&quot;, tmp);
                    }
                    best=tmp;
//                    log.info(&quot;best: {}&quot;, best);
                }
                return;
            }
            for (int i=beg;i&lt;n;++i) {
                int t=perm[beg];
                perm[beg]=perm[i];
                perm[i]=t;
//                log.info(&quot;perm[{}]: {}&quot;, beg, perm[beg]);
                int newLen = len;
                if (beg==0) newLen=A[perm[beg]].length();
                else newLen+=A[perm[beg]].length()-overlaps[perm[beg-1]][perm[beg]];
                if (newLen&lt;best.length()) {
                    dfs(perm, beg + 1, n, A, newLen);
                }
                perm[i]=perm[beg];
                perm[beg]=t;
            }
        }
        public String shortestSuperstring(String[] A) {
            int n=A.length;
            overlaps = new int[n][n];
<A NAME="1"></A>            best=&quot;&quot;;
            for (int i=0;i&lt;n;++i) {
                best=best +A[i];
                <FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match28-0.html#1',2,'match28-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>for (int j=0;j&lt;n;++j) {
                    if (i==j) continue;
                    overlaps[i][j]=calc(A[i], A[j]);
//                    log.info(&quot;Overlap({},{}):{}&quot;, A[i], A[j], overlaps[i][j]);
                }
            }
            int[]perm=new int[n];</B></FONT>
            for (int i=0;i&lt;n;++i)perm[i]=i;
            dfs(perm, 0, n, A, 0);
            return best;

        }
}
</PRE>

</BODY>
</HTML>
