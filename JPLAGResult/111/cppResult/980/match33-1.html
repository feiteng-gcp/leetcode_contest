<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>178_wjli.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>178_wjli.cpp</CENTER></H3><HR>
<PRE>

class Solution {
	int n, best;
	vector&lt;vector&lt;int&gt;&gt; v;
	vector&lt;int&gt; ans, bestans;
	vector&lt;bool&gt; used;
	vector&lt;string&gt; s;

	void solve(int step, int last, int sl) {
		if (sl &gt; best) return;
		if(step &gt; 0) ans[step - 1] = last;
		if (last &gt;= 0)used[last] = true;
		if (step == n) {
			best = sl;
			bestans = ans;
		}
		else {
			int i, j, k;
			for (i = 0; i &lt; n; i++) {
				if (!used[i]) {
					if (step == 0) solve(step + 1, i, s[i].length());
					else solve(step + 1, i, sl - v[last][i] + s[i].length());
				}				
			}
		}
		if(last &gt;= 0)used[last] = false;
	}

public:
	string shortestSuperstring(vector&lt;string&gt;&amp; A) {
<A NAME="0"></A>		n = A.size();
		s = A;
		int i, j, k;
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match33-0.html#0',2,'match33-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>		v.resize(n, vector&lt;int&gt;(n));
		for (i = 0; i &lt; n; i++) {
			for (j = 0; j &lt; n; j++) {
				for (k = min(A[i].size(), A[j].size()); k &gt;= 0; k--) {
					if (A[i].substr(A[i].length() - k) == A[j].substr(0, k)) {</B></FONT>
						v[i][j] = k;
						break;
					}
				}
			}
		}

		best = 10000;
		ans.assign(n, -1);
		used.assign(n, false);
		solve(0, -1, 0);

		string ss = s[bestans[0]];
		for (i = 1; i &lt; n; i++) {
			ss = ss.substr(0, ss.length() - v[bestans[i - 1]][bestans[i]]);
			ss = ss + s[bestans[i]];
		}		
		return ss;
	}
};
</PRE>
</BODY>
</HTML>
