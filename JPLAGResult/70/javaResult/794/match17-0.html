<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>24_jq_huang.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>24_jq_huang.java</CENTER></H3><HR>
<PRE>
<A NAME="0"></A><FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match17-1.html#0',3,'match17-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>class Solution {
  
  int[][] adj = new int[][] {{1, 0}, {-1, 0}, {0, 1}, {0, -1}</B></FONT>};
  
  public int swimInWater(int[][] grid) {
    int n = grid.length;
    int nsqr = n * n;
    int[][][] parent = new int[n][n][2];
    for (int i = 0; i != n; ++i)
      for (int j = 0; j != n; ++j) {
        parent[i][j][0] = i;
        parent[i][j][1] = j;
      }
    int[][] pos = new int[nsqr][2];
    for (int i = 0; i != n; ++i)
      for (int j = 0; j != n; ++j) {
        int ele = grid[i][j];
        pos[ele][0] = i;
        pos[ele][1] = j;
      }
    for (int i = 0; i != nsqr; ++i) {
      int x = pos[i][0];
      int y = pos[i][1];
      for (int j = 0; j != 4; ++j) {
        int nx = x + adj[j][0];
        int ny = y + adj[j][1];
        if (nx &lt; 0 || nx &gt;= n || ny &lt; 0 || ny &gt;= n) continue;
        if (grid[nx][ny] &gt; grid[x][y]) continue;
        int[] anc1 = ancestor(parent, x, y);
        int[] anc2 = ancestor(parent, nx, ny);
        parent[anc2[0]][anc2[1]][0] = anc1[0];
        parent[anc2[0]][anc2[1]][1] = anc1[1];
<A NAME="1"></A>      }
      int[] head = ancestor(parent, 0, 0);
      int[] tail = ancestor(parent, n - 1, n - 1);
      if (head[0] == tail[0] &amp;&amp; head[1] == tail[1]) <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match17-1.html#1',3,'match17-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>return i;
    }
    return -1;
  }
  
  private int[] ancestor(int[][][] parent, int x</B></FONT>, int y) {
    while (parent[x][y][0] != x || parent[x][y][1] != y) {
      int tempx = parent[x][y][0];
      int tempy = parent[x][y][1];
      x = tempx;
      y = tempy;
    }
    return new int[] {x, y};
  }
}
</PRE>

</BODY>
</HTML>
