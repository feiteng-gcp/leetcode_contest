<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>256_hdzhang.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>256_hdzhang.cpp</CENTER></H3><HR>
<PRE>

struct Pair_Hash{
	template&lt;class T1, class T2&gt; 
	std::size_t operator() (const std::pair&lt;T1, T2&gt; &amp; p) const
	{
		return std::hash&lt;T1&gt;()(p.first) ^ std::hash&lt;T2&gt;()(p.second);
	}
};

bool check(vector&lt;int&gt; v1, vector&lt;int&gt; v2, int aa, int bb)
{
    return (((v2[0]-v1[0])*aa + (v2[1]-v1[1])*bb) == 0);
}

double dist(vector&lt;int&gt; v1, vector&lt;int&gt; v2)
{
    return sqrt((v2[1]-v1[1])*(v2[1]-v1[1])+(v2[0]-v1[0])*(v2[0]-v1[0]));
}
class Solution {
public:
<A NAME="0"></A>     
    double minAreaFreeRect(vector&lt;vector&lt;int&gt;&gt;&amp; points) {
        unordered_map&lt;pair&lt;int, int&gt;, vector&lt;int&gt;, Pair_Hash&gt; m;
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match39-1.html#0',3,'match39-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>        double maxarea=9999999999;
        for(int i=0;i&lt;points.size()-1;i++)
        {
            for(int j=i+1; j&lt;points.size();j++)
            {</B></FONT>
                int x1=points[i][0];
                int y1=points[i][1];
                int x2=points[j][0];
                int y2=points[j][1];
                if(x1==x2)
                {
                    m[{0,1}].push_back(i*50+j);
                }
                else if(y1==y2)
                {
                    m[{1,0}].push_back(i*50+j);
                }
                else
                {
                    bool f = (x1&gt;x2 &amp;&amp; y1&gt;y2) || (x1&lt;x2&amp;&amp;y1&lt;y2);
                    int x3 = abs(x1-x2);
                    int y3 = abs(y1-y2);
                    int g = __gcd(x3, y3);
                    x3/=g;
                    y3/=g;
                    if(!f) x3 = -x3;
                    m[{x3, y3}].push_back(i*50+j);
                }
            }
        }
        for(auto it: m)
        {
            auto tt = it.first;
            int aa = tt.first;
            int bb = tt.second;
            vector&lt;int&gt; vec = it.second;
            
            
            for(int i=0;i&lt;vec.size()-1;i++)
            {
                int i1 = vec[i]/50;
                int j1 = vec[i]%50;
                double d1 = dist(points[i1], points[j1]);
                for(int j=i+1;j&lt;vec.size();j++)
                {
                    int i2= vec[j]/50;
                    int j2= vec[j]%50;
                    if(i1==i2 || j1==j2 || i1==j2 || i2==j1) continue;
                    
                    if(check(points[i1], points[i2], aa, bb) &amp;&amp; check(points[j1], points[j2], aa, bb))
                    {
                        double area = dist(points[i1], points[i2]) * d1;
                        if(area&gt;0) 
                        {   
<A NAME="1"></A>                            maxarea = min(maxarea, area);
                        }
                    }
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match39-1.html#1',3,'match39-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>                    if(check(points[i1], points[j2], aa, bb) &amp;&amp; check(points[j1], points[i2], aa, bb))
                    {
                        double area = dist(points[i1], points[j2]) * d1;
                        if(area&gt;0) 
                        {
                            maxarea = min(maxarea, area);
                        }
                    }
                }
            }
        }</B></FONT>
        return (maxarea==9999999999)?0:maxarea;
    }
};
</PRE>
</BODY>
</HTML>
