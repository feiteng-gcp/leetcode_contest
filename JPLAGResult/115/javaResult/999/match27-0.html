<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>30_lydxlx.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>30_lydxlx.java</CENTER></H3><HR>
<PRE>
import java.util.*;
import java.util.stream.*;
import java.math.*;

public class Solution {

    Map&lt;String, String&gt; parent = new HashMap&lt;&gt;();

    String find(String i) {
        parent.putIfAbsent(i, i);

        if (!parent.get(i).equals(i)) {
            parent.put(i, find(parent.get(i)));
        }
        return parent.get(i);
    }

    void union(String i, String j) {
        parent.put(find(i), find(j));
    }

    public int regionsBySlashes(String[] grid) {
        parent = new HashMap&lt;&gt;();

        int r = grid.length;
        int c = grid[0].length();

<A NAME="0"></A>        char[][] g = new char[r][];
        for (int i = 0; i &lt; r; i++) {
            g[i] = grid[i].toCharArray();
        <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match27-1.html#0',3,'match27-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

        for (int i = 0; i &lt; r; i++) {
            for (int j = 0; j &lt; c; j++) {
                String up = key(i, j, 'u');
                String down = key(i, j, 'd')</B></FONT>;
                String left = key(i, j, 'l');
                String right = key(i, j, 'r');

                if (g[i][j] == ' ') {
<A NAME="1"></A>                    union(up, down);
                    union(up, left);
                    union(up, right);
                } else <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match27-1.html#1',3,'match27-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (g[i][j] == '/') {
                    union(left, up);
                    union(right, down);
                } else if (g[i][j] == '\\') {
                    union(right, up);
                    union(left, down);
                }</B></FONT>

                if (j + 1 &lt; c) {
                    union(right, key(i, j + 1, 'l'));
                }
                if (i + 1 &lt; r) {
                    union(down, key(i + 1, j, 'u'));
                }
            }
        }

<A NAME="2"></A>        Set&lt;String&gt; res = new HashSet&lt;&gt;();
        for (String s : parent.keySet()) {
            res.add(find(s));
        <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match27-1.html#2',3,'match27-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        return res.size();
    }

    String key(int i, int j, char dir</B></FONT>) {
        return i + &quot;,&quot; + j + &quot;,&quot; + dir;
    }


    public static void main(String[] args) {
        Solution sol = new Solution();
        System.out.println(sol.regionsBySlashes(new String[]{
                &quot; /&quot;,
                &quot;/ &quot;,
        }));
        System.out.println(sol.regionsBySlashes(new String[]{
                &quot; /&quot;,
                &quot;  &quot;,
        }));
        System.out.println(sol.regionsBySlashes(new String[]{
                &quot;\\/&quot;,
                &quot;/\\&quot;,
        }));
        System.out.println(sol.regionsBySlashes(new String[]{
                &quot;/\\&quot;,
                &quot;\\/&quot;,
        }));
        System.out.println(sol.regionsBySlashes(new String[]{
                &quot;//&quot;,
                &quot;/ &quot;,
        }));
        System.out.println(sol.regionsBySlashes(new String[]{
                &quot;  &quot;,
                &quot;  &quot;,
        }));
    }
}

</PRE>

</BODY>
</HTML>
