<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>53_nevergiveup.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>53_nevergiveup.java</CENTER></H3><HR>
<PRE>
class Solution {

	private boolean[][][][] graph = new boolean[40][40][4][4];
	private boolean[][][] vis = new boolean[40][40][4];
	
    public int regionsBySlashes(String[] grid) {
        
    	int i , j , k , n = grid.length , m = grid[0].length();
    	for (i = 0;i &lt; n;i ++) {
    		for (j = 0;j &lt; m;j ++) {
    			graph[i][j][0][1] = true;
    			graph[i][j][0][3] = true;
    			graph[i][j][1][0] = true;
    			graph[i][j][1][2] = true;
    			graph[i][j][2][1] = true;
    			graph[i][j][2][3] = true;
    			graph[i][j][3][0] = true;
    			graph[i][j][3][2] = true;
    		}
    	}
    	for (i = 0;i &lt; n;i ++) {
    		for (j = 0;j &lt; m;j ++) {
    			if (grid[i].charAt(j) == '/') {    				
    				graph[i][j][0][1] = false;
    				graph[i][j][1][0] = false;
    				graph[i][j][3][2] = false;
    				graph[i][j][2][3] = false;
    			} else if (grid[i].charAt(j) == '\\') {
    				graph[i][j][0][3] = false;
    				graph[i][j][3][0] = false;
    				graph[i][j][1][2] = false;
    				graph[i][j][2][1] = false;
    			}
    		}
    	}
    	
<A NAME="0"></A>    	int ans = 0;
    	for (i = 0;i &lt; n;i ++) {
    		for (j = 0;j &lt; m;j ++) {
    			for (k = 0;k &lt; 4;k ++) {<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match7-0.html#0',2,'match7-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>
    				if (!vis[i][j][k]) {
    					dfs(i , j , k , n , m);
    					ans ++;
    				}
    			}
    		}
    	}
    	return ans;
    	
    }
	
    private void dfs(int x , int y , int index , int n , int m) {</B></FONT>
    	
    	vis[x][y][index] = true;
    	// internal traverse
    	for (int i = 0;i &lt; 4;i ++) {
    		if (graph[x][y][index][i] &amp;&amp; !vis[x][y][i]) {
    			dfs(x , y , i , n , m);
    		}
    	}
<A NAME="1"></A>    	// outer traverse
    	if (index == 0) {
    		if (x - 1 &gt;= 0 &amp;&amp; !vis[x - 1][y][2]) {    			
    			dfs(x - 1 , y , 2<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match7-0.html#1',2,'match7-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B> , n , m);
<A NAME="2"></A>    		}
    	} else if (index == 1) {
    		if (y + 1 &lt; m &amp;&amp; !vis[x][y + 1][3]) {</B></FONT>
    			dfs(x , y + 1 , 3<FONT color="#77bfc7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match7-0.html#2',2,'match7-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B> , n , m);
    		}
    	} else if (index == 2) {    		
    		if (x + 1 &lt; n &amp;&amp; !vis[x + 1][y][0]) {</B></FONT>
    			dfs(x + 1 , y , 0 , n , m);
    		}
    	} else {
    		if (y - 1 &gt;= 0 &amp;&amp; !vis[x][y - 1][1]) {
    			dfs(x , y - 1 , 1 , n , m);
    		}
    	}
    	
    }
	
}
</PRE>

</BODY>
</HTML>
