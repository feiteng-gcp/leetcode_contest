<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>242_ShoreX.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>242_ShoreX.java</CENTER></H3><HR>
<PRE>
class Solution {
    Map&lt;Integer, Integer&gt; father = new HashMap&lt;&gt;();
    private int find(int x) {
        if (x == father.get(x)) return x;
        father.put(x, find(father.get(x)));
        return father.get(x);
    }
    private void union(int a, int b) {
        int rootA = find(a), rootB = find(b);
        if (rootA != rootB) {
            father.put(rootA, rootB);
        }
    }
    int n;
    public int regionsBySlashes(String[] grid) {
        // divided to 2 * n * n part
        // union find
        n = grid.length;
        int num = n * (4 * n);
        for (int i = 0; i &lt; num; i++) {
            father.put(i, i);
        }
        
        char[][] charGrid = new char[n][n];
        for (int r = 0; r &lt; n; r++) {
            int c = 0;
            for (int i = 0; i &lt; grid[r].length(); i++) {
                if (grid[r].charAt(i) == ' ') {
                    charGrid[r][c] = ' ';
                }
                if (grid[r].charAt(i) == '/') {
                    charGrid[r][c] = '/';
                }
                if (grid[r].charAt(i) == '\\') {
                    charGrid[r][c] = '\\';
                }
                c++;
            }
        }
<A NAME="0"></A>        
        int[] dr = { -1, 0, 1, 0 };
        int[] dc = { 0, 1, 0, -1 };
        <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match31-1.html#0',3,'match31-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>for (int r = 0; r &lt; n; r++) {
            for (int c = 0; c &lt; n; c++) {
                if (charGrid[r][c] != '\\') {
                    union</B></FONT>(toIndex(r, c), toIndex(r, c) + 3);
                    union(toIndex(r, c) + 1, toIndex(r, c) + 2);
                }
                if (charGrid[r][c] != '/') {
                    union(toIndex(r, c), toIndex(r, c) + 1);
                    union(toIndex(r, c) + 2, toIndex(r, c) + 3);
                }
                for (int i = 0; i &lt; 4; i++) {
                    int nr = r + dr[i];
                    int nc = c + dc[i];
                    if (isValid(nr, nc)) {
                        if (i == 0) {
                            union(toIndex(r, c), toIndex(nr, nc) + 2);
                        }
                        if (i == 1) {
                            union(toIndex(r, c) + 1, toIndex(nr, nc) + 3);
                        }
                        if (i == 2) {
                            union(toIndex(r, c) + 2, toIndex(nr, nc));
                        }
                        if (i == 3) {
                            union(toIndex(r, c) + 3, toIndex(nr, nc) + 1);
                        }
                    }
                }
            }
        }
                    
        int count = 0;
        for (int i = 0; i &lt; num; i++) {
            if (i == find(i)) {
                count++;
            }
        }
        return count;
    }
    private int toIndex(int r, int c) {
        return r * 4 * n + 4 * c;
    }
    private boolean isValid(int r, int c) {
        if (r &gt;= 0 &amp;&amp; r &lt; n &amp;&amp; c &gt;= 0 &amp;&amp; c &lt; n) {
            return true;
        }
        return false;
    }
}
</PRE>

</BODY>
</HTML>
