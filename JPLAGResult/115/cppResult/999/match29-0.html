<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>32_goddice.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>32_goddice.cpp</CENTER></H3><HR>
<PRE>
class UnionFind {
    int *id, cnt, *sz;
public:
	// Create an empty union find data structure with N isolated sets.
     UnionFind(int N) {
        cnt = N;
        id = new int[N];
        sz = new int[N];
            for(int i=0; i&lt;N; i++)	{
                id[i] = i;
            sz[i] = 1;
        }
    }
    ~UnionFind() {
        delete [] id;
        delete [] sz;
    }
	// Return the id of component corresponding to object p.
    int find(int p)	{
        int root = p;
        while (root != id[root])
            root = id[root];
        while (p != root) {
            int newp = id[p];
<A NAME="0"></A>            id[p] = root;
            p = newp;
        }
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match29-1.html#0',3,'match29-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>        return root;
    }
    
	// Replace sets containing x and y with their union.
    void merge(int x, int y) {
        int i = find(x);
        int j = find(y);
        if (i == j) return;</B></FONT>
		
		// make smaller root point to larger one
        if   (sz[i] &lt; sz[j])	{ 
            id[i] = j; 
            sz[j] += sz[i]; 
        } else	{ 
            id[j] = i; 
<A NAME="1"></A>            sz[i] += sz[j]; 
        }
        cnt--;
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match29-1.html#1',3,'match29-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>    }
    
	// Return the number of disjoint sets.
    int count() {
        return cnt;
    }
};


class Solution {
public:
    int regionsBySlashes(vector&lt;string&gt;&amp; grid) {
<A NAME="2"></A>        int n = grid.size();</B></FONT>
        UnionFind uf(2 * n * n);
        
<FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match29-1.html#2',3,'match29-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>        for (int i = 0; i &lt; n; ++i) {
            for (int j = 0; j &lt; n; ++j) {
                int id = i * n + j;</B></FONT>
                if (grid[i][j] == ' ') {
                    uf.merge(2 * id, 2 * id + 1);
                    if (i &gt; 0) {
                        int aid = (i - 1) * n + j;
                        if (grid[i-1][j] == '/') {
                            uf.merge(2 * id, 2 * aid + 1);
                        }
                        else {
                            uf.merge(2 * id, 2 * aid);
                        }                        
                    }
                    if (j &gt; 0) {
                        int lid = i * n + (j - 1);
                        uf.merge(2 * id, 2 * lid + 1);
                    }
                }
                else if (grid[i][j] == '/') {
                    if (i &gt; 0) {
                        int aid = (i - 1) * n + j;
                        if (grid[i-1][j] == '/') {
                            uf.merge(2 * id, 2 * aid + 1);
                        }
                        else {
                            uf.merge(2 * id, 2 * aid);
                        }                        
                    }
                    if (j &gt; 0) {
                        int lid = i * n + (j - 1);
                        uf.merge(2 * id, 2 * lid + 1);
                    }
                }
                else {
                    if (i &gt; 0) {
                        int aid = (i - 1) * n + j;
                        if (grid[i-1][j] == '/') {
                            uf.merge(2 * id + 1, 2 * aid + 1);
                        }
                        else {
                            uf.merge(2 * id + 1, 2 * aid);
                        }                        
                    }
                    if (j &gt; 0) {
                        int lid = i * n + (j - 1);
                        uf.merge(2 * id, 2 * lid + 1);
                    }
                }
            }
        }
        
        return uf.count();
    }
};
</PRE>
</BODY>
</HTML>
