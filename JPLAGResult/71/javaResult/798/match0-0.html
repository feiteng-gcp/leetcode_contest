<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>5_nevergiveup.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>5_nevergiveup.java</CENTER></H3><HR>
<PRE>
class Solution {
	private int getResult(List&lt;Integer&gt; list) {
		
		int value1 = 0 , value2 = 0 , ans = - 1;
		
		int cnt1 = 0 , cnt2 = 0;
		for (int i = 0;i &lt; list.size();i ++) {
			int need = (i % 2 == 0) ? 1 : 0;
			if (list.get(i) != need) {
				value1 ++;
			}
			if (list.get(i) == 0) {
				cnt1 ++;
			}
			if (need == 0) {
				cnt2 ++;
			}
		}
		if (cnt1 == cnt2) {
			value1 /= 2;
			if (value1 &lt; ans || ans &lt; 0) {
				ans = value1;
			}
		}
		
		cnt1 = cnt2 = 0;
		for (int i = 0;i &lt; list.size();i ++) {
			int need = (i % 2 == 0) ? 0 : 1;
			if (list.get(i) != need) {
				value2 ++;
			}
			if (list.get(i) == 0) {
				cnt1 ++;
			}
			if (need == 0) {
				cnt2 ++;
			}
		}
		if (cnt1 == cnt2) {
			value2 /= 2;
			if (value2 &lt; ans || ans &lt; 0) {
<A NAME="0"></A>				ans = value2;
			}
		}
		return ans;<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match0-1.html#0',3,'match0-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>
		
	}
	
	private boolean check(int[][] board) {
		
		int i , j , n = board.length;</B></FONT>
		for (int row1 = 0;row1 &lt; n;row1 ++) {
			for (int row2 = row1;row2 &lt; n;row2 ++) {
				int cnt1 = 0 , cnt2 = 0;
				for (j = 0;j &lt; n;j ++) {
					if (board[row1][j] == board[row2][j]) {
						cnt1 ++;
					} else {
						cnt2 ++;
					}
				}
				if (cnt1 &gt; 0 &amp;&amp; cnt2 &gt; 0) {
					return false;
				}
			}
		}
		
		for (int col1 = 0;col1 &lt; n;col1 ++) {
			for (int col2 = col1;col2 &lt; n;col2 ++) {
				int cnt1 = 0 , cnt2 = 0;
				for (i = 0;i &lt; n;i ++) {
					if (board[i][col1] == board[i][col2]) {
						cnt1 ++;
					} else {
						cnt2 ++;
					}
				}
				if (cnt1 &gt; 0 &amp;&amp; cnt2 &gt; 0) {
					return false;
				}
			}
		}
		
		int cnt1 = 0 , cnt2 = 0;
		for (i = 0;i &lt; n;i ++) {
			if (board[i][0] == 0) {
				cnt1 ++;
			}
			if (board[0][i] == 0) {
				cnt2 ++;
			}
		}
		if (n % 2 == 0) {
			if ((cnt1 == n / 2) &amp;&amp; (cnt2 == n / 2)) {
				return true;
<A NAME="1"></A>			} else {
				return false;
			}
		} else {<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match0-1.html#1',3,'match0-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>
			if (((cnt1 == n / 2) || (cnt1 == n / 2 + 1)) &amp;&amp;
				((cnt2 == n / 2) || (cnt2 == n / 2 + 1))) {
				return true;
			} else {
				return false;
			}
		}
		
	}</B></FONT>
	
    public int movesToChessboard(int[][] board) {
     
    	if (check(board)) {
    		List&lt;Integer&gt; list1 = new ArrayList&lt;&gt;() , list2 = new ArrayList&lt;&gt;();
    		int i , j , n = board.length , m = board[0].length;
    		for (i = 0;i &lt; n;i ++) {
    			list1.add(board[i][0]);
    		}
    		for (j = 0;j &lt; m;j ++) {
    			list2.add(board[0][j]);
    		}
    		return getResult(list1) + getResult(list2);
    	} else {
    		return - 1;
    	}
    	
    }
}
</PRE>

</BODY>
</HTML>
