<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>2_cuiaoxiang.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>2_cuiaoxiang.cpp</CENTER></H3><HR>
<PRE>
const int N = 1e5 + 10;
const int SIGMA = 256;

struct SuffixArray {
  int s[N]; // last char must be smallest.
  int sa[N], r[N], height[N];
  int t[2][N], c[N];
  int n;

<A NAME="0"></A>  void da(int m) {
    int *x = t[0], *y = t[1];
    fill(c, c + m, 0);
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match16-1.html#0',3,'match16-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>    for (int i = 0; i &lt; n; ++i) c[x[i] = s[i]]++;
<A NAME="1"></A>    for (int i = 1; i &lt; m; ++i) c[i] += c[i - 1];
    for (int i = n - 1; i &gt;= 0; --i) sa[--c[x[i]]] = i;
    for (int k = 1, p = 0; p &lt; n; k &lt;&lt;= 1, m = p) {</B></FONT>
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match16-1.html#1',3,'match16-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>      p = 0;
      for (int i = n - k; i &lt; n; ++i) y[p++] = i;
      for (int i = 0; i &lt; n; ++i) if (sa[i] &gt;= k) y[p++] = sa[i] - k;
      fill(c, c + m, 0);
      for (int i = 0; i &lt; n; ++i) c[x[y[i]]]++;
      for (int i = 1; i &lt; m; ++i) c[i] += c[i - 1];
      for (int i = n - 1; i &gt;= 0; --i) sa[--c[x[y[i]]]] = y[i];</B></FONT>
      swap(x, y);
      x[sa[0]] = 0; p = 1;
      for (int i = 1; i &lt; n; ++i) {
        x[sa[i]] = y[sa[i - 1]] == y[sa[i]] &amp;&amp;
          y[sa[i - 1] + k] == y[sa[i] + k] ? p - 1 : p++;
      }
    }
  }
};

class Solution {
public:
    string lastSubstring(string s) {
        SuffixArray sa;
        copy(s.begin(), s.end(), sa.s);
        sa.n = s.size() + 1;
        sa.s[sa.n - 1] = 0;
        sa.da(SIGMA);
        int k = sa.sa[sa.n - 1];
        return s.substr(k);
    }
};
</PRE>
</BODY>
</HTML>
