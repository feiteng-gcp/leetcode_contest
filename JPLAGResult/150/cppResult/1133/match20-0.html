<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>39_DickLearning.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>39_DickLearning.cpp</CENTER></H3><HR>
<PRE>
#define REP(i, n) for (int i = 0; i &lt; n; ++i)
template &lt;size_t maxn&gt; struct SuffixArray {
  const char *s;
  int n, sa[maxn], rank[maxn], height[maxn];
  int t[maxn], t2[maxn], c[maxn];
  SuffixArray(const char *s) : s(s) {
    n = strlen(s) + 1;
    build_sa(128);
    build_height();
  }
  SuffixArray() {}
  void build_sa(int m) {
<A NAME="0"></A>    int i, *x = t, *y = t2;
    REP(i, m) c[i] = 0;
    REP(i, n) c[x[i] = s[i]]++;
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match20-1.html#0',3,'match20-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>    REP(i, m) if (i) c[i] += c[i - 1];
    for (i = n - 1; i &gt;= 0; i--)
      sa[--c[x[i]]] = i;
    for (int k = 1; k &lt;= n; k &lt;&lt;= 1) {
      int p = 0;
      for (i = n - k; i &lt; n; i++)
        y[p++] = i;</B></FONT>
<A NAME="1"></A>      REP(i, n) if (sa[i] &gt;= k) y[p++] = sa[i] - k;
      REP(i, m) c[i] = 0;
      REP(i, n) c[x[y[i]]]++;
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match20-1.html#1',3,'match20-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>      REP(i, m) if (i) c[i] += c[i - 1];
      for (i = n - 1; i &gt;= 0; i--)
        sa[--c[x[y[i]]]] = y[i];
      swap(x, y);
      p = 1;
      x[sa[0]] = 0;
      for (i = 1; i &lt; n; i++)
        x[sa[i]] = y[sa[i - 1]] == y[sa[i]] &amp;&amp; y[sa[i - 1] + k] == y[sa[i] + k]
                       ? p - 1
                       : p++;
      if (p &gt;= n)
        break;
      m = p;
    }
  }
  void build_height() {
    int i, k = 0;
    for (i = 0; i &lt; n; i++)
      rank[sa[i]] = i;</B></FONT>
    height[0] = 0;
    for (i = 0; i &lt; n; i++) {
      if (rank[i] == 0)
<A NAME="2"></A>        continue;
      if (k)
        k--;
<FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match20-1.html#2',3,'match20-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>      int j = sa[rank[i] - 1];
      while (s[i + k] == s[j + k])
        k++;
      height[rank[i]] = k;
    }
  }
};


class Solution {
public:
    string lastSubstring(string s) {
        SuffixArray&lt;100010&gt; a(s.c_str());
        int p = a.sa[a.n - 1];</B></FONT>
        return s.substr(p);
    }
};
</PRE>
</BODY>
</HTML>
