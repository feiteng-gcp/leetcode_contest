<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>1_uwi.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>1_uwi.java</CENTER></H3><HR>
<PRE>
	class Solution {
	    public boolean splitArraySameAverage(int[] a) {
	    	int n = a.length;
	    	int s = 0;
	    	for(int v : a){
	    		s += v;
	    	}
	    	int m = (300001&gt;&gt;&gt;6)+1;
	    	long[][] dp = new long[n+1][m];
	    	dp[0][0] = 1;
	    	for(int i = 0;i &lt; n;i++){
	    		for(int j = i;j &gt;= 0;j--){
	    			or(dp[j], 0, 300000-a[i], dp[j+1], a[i]);
	    		}
	    	}
	    	for(int i = 1;i &lt;= n-1;i++){
	    		// a/i = (s-a)/(n-i)
	    		// a(n-i) = (s-a)i
	    		// an = si
	    		// a = si/n
<A NAME="0"></A>	    		if((long)s * i % n == 0){
	    			int b = s*i / n;
	    			if(dp[i][b&gt;&gt;&gt;6]&lt;&lt;~b&lt;0)return true;
	    		}<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match22-0.html#0',2,'match22-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>
	    	}
	    	return false;
	    }
	    
		public void or(long[] from, int fl, int fr, long[] to, i</B></FONT>nt tl)
		{
			if(!(fl &gt;= 0 &amp;&amp; fl &lt; from.length&lt;&lt;6))throw new RuntimeException();
			if(!(fr &gt;= 0 &amp;&amp; fr &lt;= from.length&lt;&lt;6))throw new RuntimeException();
			if(!(tl &gt;= 0 &amp;&amp; tl &lt; to.length&lt;&lt;6))throw new RuntimeException();
			if(!(tl+(fr-fl) &gt;= 0 &amp;&amp; tl+(fr-fl) &lt;= to.length&lt;&lt;6))throw new RuntimeException();
			if(fl &gt;= fr)return;
			
			int tr = tl+(fr-fl);
			for(int l1 = fl, l2 = Math.min(fr, (fl&gt;&gt;&gt;6)+1&lt;&lt;6), r1 = tl, r2 = Math.min(tr, (tl&gt;&gt;&gt;6)+1&lt;&lt;6);l1 &lt; fr;){
				if(l2-l1 &lt;= r2-r1){
					long f = from[l2-1&gt;&gt;&gt;6]&lt;&lt;-l2&gt;&gt;&gt;-l2+l1;
					to[l2-l1+r1-1&gt;&gt;&gt;6] |= f&lt;&lt;r1;
					r1 += l2-l1;
					l1 = l2;
					l2 = Math.min(fr, (l1&gt;&gt;&gt;6)+1&lt;&lt;6);
					if(r2 - r1 == 0){
						r2 = Math.min(tr, (r1&gt;&gt;&gt;6)+1&lt;&lt;6);
					}
				}else{
					long f = from[r2-r1+l1-1&gt;&gt;&gt;6]&lt;&lt;-(r2-r1+l1)&gt;&gt;&gt;-(r2-r1+l1)+l1;
					to[r2-1&gt;&gt;&gt;6] |= f&lt;&lt;r1;
					l1 += r2-r1;
					r1 = r2;
					r2 = Math.min(tr, (r1&gt;&gt;&gt;6)+1&lt;&lt;6);
					if(l2 - l1 == 0){
						l2 = Math.min(fr, (l1&gt;&gt;&gt;6)+1&lt;&lt;6);
					}
				}
			}
		}
		
	}	
</PRE>

</BODY>
</HTML>
