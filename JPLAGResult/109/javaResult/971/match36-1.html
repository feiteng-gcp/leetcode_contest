<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>315_YYStreet.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>315_YYStreet.java</CENTER></H3><HR>
<PRE>
class Solution {
    public int shortestBridge(int[][] A) {
        int rows = A.length;
<A NAME="1"></A>        int cols = A[0].length;
        Set&lt;Coor&gt; isA = new HashSet&lt;&gt;();
        Set&lt;Coor&gt; isB = new HashSet&lt;&gt;();
        <FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match36-0.html#1',2,'match36-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>boolean beginB = false;
        for(int i = 0; i &lt; rows; i++) {
           for(int j = 0; j &lt; cols; j++) {
               if(!beginB) {
                   if(A[i][j] == 1) {
                       isA.add</B></FONT>(new Coor(i, j));
                       dfs(new Coor(i, j), A, isA);
                       beginB = true;
                   }
               } else {
                  if(A[i][j] == 1 &amp;&amp; !isA.contains(new Coor(i, j))) {
                      isB.add(new Coor(i, j));
                      dfs(new Coor(i, j), A, isB);
                   } 
               }
           }
        }
        // for(Coor curr: isA) {
        //     System.out.println(curr.row + &quot; &quot; + curr.col);
        // }
        // System.out.println();
        // for(Coor curr: isB) {
        //     System.out.println(curr.row + &quot; &quot; + curr.col);
        // }
        Set&lt;Coor&gt; fromSet = isA;
        Set&lt;Coor&gt; toSet = isB;
        if(isA.size() &gt; isB.size()) {
            fromSet = isB;
            toSet = isA;
        }
        int shortest = Integer.MAX_VALUE;
        for(Coor from: fromSet) {
            shortest = Math.min(shortest, bfs(from, fromSet, toSet, A, shortest));
            if(shortest == 1) {
<A NAME="6"></A>                break;
            }
        }
        <FONT color="#50ebec"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match36-0.html#6',2,'match36-top.html#6',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>return shortest;
    }
<A NAME="0"></A>    private int bfs(Coor from, Set&lt;Coor&gt; fromSet, Set&lt;Coor&gt; toSet, int[][] A, int formerShortest) {</B></FONT>
        int rows = A.length;
        int cols = A[0].length;
        <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match36-0.html#0',2,'match36-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>int[][] dirs = new int[][]{{-1, 0}, {0, 1}, {1, 0}, {0, -1}</B></FONT>};
        Queue&lt;Coor&gt; queue = new LinkedList&lt;&gt;();
        queue.offer(from);
<A NAME="3"></A>        Set&lt;Coor&gt; visited = new HashSet&lt;&gt;();
        visited.add(from);
        int level = 0;
        <FONT color="#6cc417"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match36-0.html#3',2,'match36-top.html#3',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>while(!queue.isEmpty()) {
            int size = queue.size();
            for(int i = 0; i &lt; size; i++) {
                Coor curr = queue.poll();
                for(int[] dir: dirs) {
                    int newRow = curr.row + dir[0];
<A NAME="4"></A>                    int newCol = curr.col + dir[1];
                    if(newRow &gt;= 0 &amp;&amp; newRow &lt; rows &amp;&amp; newCol &gt;= 0 &amp;&amp; newCol &lt; cols) {</B></FONT>
                        Coor next = new Coor(newRow, newCol);
                        <FONT color="#151b8d"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match36-0.html#4',2,'match36-top.html#4',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>if(A[newRow][newCol] == 1) {
                            if(toSet.contains(next)) {
                                return level;
                            }
<A NAME="5"></A>                        } else {
                            if</B></FONT>(visited.add(next)) {
                                queue.offer(next);
                            <FONT color="#c8c2a7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match36-0.html#5',2,'match36-top.html#5',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>}
                        }
                    }
                }
            }</B></FONT>
            level++;
            if(level &gt;= formerShortest) {
                break;
            }
        }
        return Integer.MAX_VALUE;
    }
    private void dfs(Coor curr, int[][] A, Set&lt;Coor&gt; set) {
        int rows = A.length;
        int cols = A[0].length;
        int[][] dirs = new int[][]{{-1, 0}, {0, 1}, {1, 0}, {0, -1}};
        for(int[] dir: dirs) {
            int newRow = curr.row + dir[0];
<A NAME="2"></A>            int newCol = curr.col + dir[1];
            if(newRow &gt;= 0 &amp;&amp; newRow &lt; rows &amp;&amp; newCol &gt;= 0 &amp;&amp; newCol &lt; cols &amp;&amp; A[newRow][newCol] == 1) {
                Coor next = new Coor(newRow, newCol);
                if(set.add(next)) <FONT color="#77bfc7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match36-0.html#2',2,'match36-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>{
                    dfs(next, A, set);
                }
            }
        }
    }</B></FONT>
    
    class Coor {
        int row;
        int col;
        public Coor(int row, int col) {
            this.row = row;
            this.col = col;
        }
        
        @Override
        public int hashCode() {
            return row * 7 + col * 13;
        }
        
        @Override
        public boolean equals(Object obj) {
            if(obj == null || !(obj instanceof Coor)) {
                return false;
            }
            Coor another = (Coor) obj;
            return row == another.row &amp;&amp; col == another.col;
        }
    }
}
</PRE>

</BODY>
</HTML>
