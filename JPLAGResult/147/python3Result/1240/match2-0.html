<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>358_fanzhh.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>358_fanzhh.py</CENTER></H3><HR>
<PRE>
<A NAME="0"></A><FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match2-1.html#0',3,'match2-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>class Solution:
    def stoneGameII(self, piles: List[int]) -&gt; int:
        # memo dfs
        N = len(piles)
        # calculating prefix
        pre = [0] * (N + 1)
        for i in range(N):
            pre[i + 1] = pre[i] + piles[i]
        
        memset = set()
        self.MM = 0
        # turn: Alex = 0, Lee = 1
        
        from functools import lru_cache
        @lru_cache(None)
        def dfs(start, curM, turn):
            if start &gt;= N:
                return 0
            if start + 2 * curM - 1 &gt;= N - 1:
                if turn == 0:
                    return pre[N] - pre[start]
                else:
                    return 0
            if turn == 0:
                res = 0
                for take in range(1, 2 * curM + 1):
                    # start: start
                    # end: start + take - 1
                    res = max(res, pre[start + take] - pre[start] + dfs(start + take, max(curM, take), 1))
                return res
            else:
                res = sys.maxsize
                for take in range(1, 2 * curM + 1):
                    res = min(res, dfs(start + take, max(curM, take), 0))
                return res
            
            
        return dfs(0</B></FONT>, 1, 0)
</PRE>

</BODY>
</HTML>
