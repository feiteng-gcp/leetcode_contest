<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>52_kjs1095.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>52_kjs1095.cpp</CENTER></H3><HR>
<PRE>
class Solution {
using Pair=pair&lt;int,int&gt;;
public:
    string makeLargestSpecial(string S) {
        vector&lt;Pair&gt; sub;
        int len = S.length();
        for (int i = 0; i &lt; len; ++i) {
            if (S[i] == '1') {
                stack&lt;char&gt; tS;
                for (int j = i; j &lt; len; ++j) {
                    if (S[j] == '1')
                        tS.push(S[j]);
                    else {
                        if (tS.empty())
                            break;
                        else
                            tS.pop();
                    }
                    
                    if (tS.empty())
                        sub.emplace_back(Pair(i, j));
                }
            }
<A NAME="0"></A>        }
        
        string ans = S;
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match14-1.html#0',3,'match14-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>        for (int i = 0; i &lt; sub.size(); ++i) {
            for (int j = i +1; j &lt; sub.size(); ++j) {
                if (sub[i].second +1 == sub[j].first) {
                    int p = sub[i].first;</B></FONT>
                    int q = sub[j].first;
                    char toChange = 0;
                    while (p &lt;= sub[i].second &amp;&amp; q &lt;= sub[j].second) {
                        if (S[q] &gt; S[p]) {
                            toChange = 1;
                            break;
                        } else if (S[p] &lt; S[q]) {
                            break;
                        }
                        ++p, ++q;
                    }
                    
                    if (toChange) {
                        string subA = S.substr(0, sub[i].first);
                        string subB = S.substr(sub[i].first, sub[i].second - sub[i].first +1);
                        string subC = S.substr(sub[j].first, sub[j].second - sub[j].first +1);
                        string subD = S.substr(sub[j].second +1);
                        
                        string tmp  =subA + subC + subB + subD;
                        if (tmp &gt; ans)
                            ans = tmp;
                    }
                }
            }
        }
        
        if (ans == S)
            return ans;
        else
            return makeLargestSpecial(ans);
    }
};
</PRE>
</BODY>
</HTML>
