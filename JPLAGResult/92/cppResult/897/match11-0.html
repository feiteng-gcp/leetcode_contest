<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>9_catalin7.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>9_catalin7.cpp</CENTER></H3><HR>
<PRE>
class Solution {
public:
    int Nd;
    
    vector&lt;vector&lt;int&gt;&gt; cand;
    vector&lt;vector&lt;int&gt;&gt; rcand;
    vector&lt;int&gt; p10;
<A NAME="0"></A>    
    bool is_prime(int x) {
        if (x &lt;= 2) return true;
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match11-1.html#0',3,'match11-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>        for (int i = 2; i * i &lt;= x; i++) {
            if (x % i == 0)
                return false;
        }
        return true;
    }
    
    int primePalindrome(int N) {
        if (N == 1) return 2;</B></FONT>
        
        stringstream ss;
        ss &lt;&lt; N;
        //cerr &lt;&lt; &quot;N : &quot; &lt;&lt; ss.str() &lt;&lt; &quot;\n&quot;;
        
        Nd = ss.str().size();
     
        if (Nd == 1) {
            //cerr &lt;&lt; &quot;Nd == 1\n&quot;;
            for (int i = N; i &lt;= 9; i++) {
                if (is_prime(i))
                    return i;
            }
            Nd++;
        }
        
        p10 = {1, 10, 100, 1000, 10000, 100000, 1000000};
        
        cand = vector&lt;vector&lt;int&gt;&gt;(6, vector&lt;int&gt;());
        rcand = cand;
        
        for (int i = 1; i &lt;= 99999; i++) {
            int cur_n = 0;
            auto x = i;
            int rx = 0;
            int fd = -1;

            while (x) {
                cur_n++;
                rx *= 10;
                fd = x % 10;
                rx += (x % 10);
                x /= 10;
            }

            if (fd == 1 || fd == 3 || fd == 7 || fd == 9) {
                cand[cur_n].push_back(i);
                rcand[cur_n].push_back(rx);
            }
        }
        
        for (int i = Nd; i &lt;= 11; i++) {
            int hf = i / 2;
            //cerr &lt;&lt; &quot;tot len: &quot; &lt;&lt; i &lt;&lt; &quot;\n&quot;;
            if (i % 2 == 1) {
                for (int k = 0; k &lt; cand[hf].size(); k++) {
                    for (int o = 0; o &lt; 10; o++) {
                        auto nr = cand[hf][k] * p10[hf + 1]  + o * p10[hf] + rcand[hf][k];     
                
                        if (nr &gt;= N &amp;&amp; is_prime(nr)) {
                            return nr;   
                        }
                    }
                }
            } else {
                for (int k = 0; k &lt; cand[hf].size(); k++) {
                    auto nr = cand[hf][k] * p10[hf] + rcand[hf][k];     
                
                    //cerr &lt;&lt; cand[hf][k] &lt;&lt; &quot; &quot; &lt;&lt; rcand[hf][k] &lt;&lt; &quot; &quot; &lt;&lt; nr &lt;&lt; &quot;\n&quot;;

                    if (nr &gt;= N &amp;&amp; is_prime(nr))
                        return nr;
                }
            }
        }
        
        return -1;
    }
};
</PRE>
</BODY>
</HTML>
