<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>405_ddoudle.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>405_ddoudle.py</CENTER></H3><HR>
<PRE>
class Solution:
    def minCost(self, grid: List[List[int]]) -&gt; int:
        m = len(grid)
        n = len(grid[0])
        if m==1 and n==1:
            return 0
        dire = {}
        dire[1] = [0,1]
        dire[2] = [0,-1]
        dire[3] = [1,0]
        dire[4] = [-1,0]
        all_set = set()
        all_set.add((0,0))
        arr2 = [[0,0]]
        
        step = 0
        arr1 = arr2
        arr2 = []
        
        
<A NAME="1"></A>        
        while arr1:
            x, y = arr1.pop(0)
            dx, dy = dire[grid[x]<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match25-0.html#1',2,'match25-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>[y]]
            x1, y1 = x+dx, y+dy
            while 0&lt;=x1&lt;m and 0&lt;=y1&lt;n and (x1,y1) not in all_set:
                if x1 == m-1 and y1 == n-1:
                    return step
                all_set.add((x1,y1))
                arr2.append([x1,y1])
                dx, dy = dire[grid[x1][y1]]
                x1, y1 =</B></FONT> x1+dx, y1+dy
        
        
        
        if arr2 == []:
            arr2 = [[1,0],[0,1]]
            if (m == 2 and n == 1) or (m == 1 and n == 2):
                return 1
            step += 1
            x, y = 1, 0
<A NAME="0"></A>            if 0&lt;=x&lt;m and 0&lt;=y&lt;n:
                dx, dy = dire[grid[x][y]]
                x1, y1 = x+dx, y+dy
                <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match25-0.html#0',2,'match25-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>while 0&lt;=x1&lt;m and 0&lt;=y1&lt;n and (x1,y1) not in all_set:
                    if x1 == m-1 and y1 == n-1:
                        return step
                    all_set.add((x1,y1))
                    arr2.append([x1,y1])
                    dx, dy = dire[grid[x1][y1]]
                    x1, y1 =</B></FONT> x1+dx, y1+dy
            x, y = 0, 1
            if 0&lt;=x&lt;m and 0&lt;=y&lt;n:
                dx, dy = dire[grid[x][y]]
                x1, y1 = x+dx, y+dy
                while 0&lt;=x1&lt;m and 0&lt;=y1&lt;n and (x1,y1) not in all_set:
                    if x1 == m-1 and y1 == n-1:
                        return step
                    all_set.add((x1,y1))
                    arr2.append([x1,y1])
                    dx, dy = dire[grid[x1][y1]]
                    x1, y1 = x1+dx, y1+dy

        while 1:
            step += 1
            arr1 = arr2
            arr2 = []
            while arr1:
                x, y = arr1.pop(0)
                for dx, dy in [[-1,0],[1,0],[0,-1],[0,1]]:                
                    x1, y1 = x+dx, y+dy
                    while 0&lt;=x1&lt;m and 0&lt;=y1&lt;n and (x1,y1) not in all_set:
                        if x1 == m-1 and y1 == n-1:
                            return step
                        all_set.add((x1,y1))
                        arr2.append([x1,y1])
                        dx, dy = dire[grid[x1][y1]]
                        x1, y1 = x1+dx, y1+dy
</PRE>

</BODY>
</HTML>
