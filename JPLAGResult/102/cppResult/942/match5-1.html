<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>190_kumalimak.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>190_kumalimak.cpp</CENTER></H3><HR>
<PRE>

// repetition
#define FOR(i,a,b) for(int i=(a);i&lt;(b);++i)
#define REP(i,n)  for(int i=0;i&lt;(n);++i)
#define FORR(x,arr) for(auto&amp; x:arr)
#define SZ(a) int((a).size())
typedef pair&lt; int , int &gt; II;
typedef unordered_map &lt; int, int &gt; MAPII;
typedef unordered_set &lt; int &gt; SETI;
typedef vector &lt; int &gt; VI;
typedef vector&lt;vector &lt; int &gt;&gt; VVI;
typedef vector&lt;vector&lt;vector &lt; int &gt;&gt;&gt; VVVI;
#define MINUS(dp) memset(dp, -1, sizeof(dp))
#define ZERO(dp) memset(dp, 0, sizeof(dp))
#define TRACE true
#define dump(x) if(TRACE) { cout &lt;&lt; #x &lt;&lt; &quot; = &quot; &lt;&lt; (x) &lt;&lt; endl; }
#define dump2(x,y) if(TRACE) { cout &lt;&lt; #x &lt;&lt; &quot; = &quot; &lt;&lt; (x) &lt;&lt; &quot;, &quot; &lt;&lt; #y &lt;&lt; &quot; = &quot; &lt;&lt; (y) &lt;&lt; endl; }
#define dump3(x,y,z) if(TRACE) { cout &lt;&lt; #x &lt;&lt; &quot; = &quot; &lt;&lt; (x) &lt;&lt; &quot;, &quot; &lt;&lt; #y &lt;&lt; &quot; = &quot; &lt;&lt; (y) &lt;&lt; &quot;, &quot; &lt;&lt; #z &lt;&lt; &quot; = &quot; &lt;&lt; (z) &lt;&lt; endl; }
#define dump4(x,y,z,a) if(TRACE) { cout &lt;&lt; #x &lt;&lt; &quot; = &quot; &lt;&lt; (x) &lt;&lt; &quot;, &quot; &lt;&lt; #y &lt;&lt; &quot; = &quot; &lt;&lt; (y) &lt;&lt; &quot;, &quot; &lt;&lt; #z &lt;&lt; &quot; = &quot; &lt;&lt; (z) &lt;&lt; &quot;, &quot; &lt;&lt; #a &lt;&lt; &quot; = &quot; &lt;&lt; (a) &lt;&lt; endl; }
#define dumpAR(ar) if(TRACE) { FORR(x,(ar)) { cout &lt;&lt; x &lt;&lt; ','; } cout &lt;&lt; endl; }
typedef long long LL;

// 19:20-
class Solution {
<A NAME="0"></A>public:
    LL L,R; 
//    int res=0;
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match5-0.html#0',2,'match5-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>    bool isp(string s) {
        int r=SZ(s)-1,l=0;
        while(l&lt;r) {
            if(s[l]!=s[r]) return false;
            ++l,--r;
        }
        return true;
    }</B></FONT>
    set&lt;LL&gt; S;
    void dfs(int i, int M, string &amp;cur) {
        if(i==(M+1)/2) {
            assert(cur[0]!='0');
//            int N=i%2==0?i:i-1;
            int N=M/2;
            string s=cur;
            string t=cur.substr(0,N); reverse(t.begin(),t.end());
            s+=t;
            LL n=0;
            REP(i,SZ(s)) n=10LL*n+(s[i]-'0');
            LL nn=n*n;
            if(nn&lt;L||nn&gt;R) return;
//            dump4(M,cur,s,nn);
            s=to_string(nn);
            if(isp(s)) S.emplace(nn);            
            return;
        }
        
        int s=i==0?1:0;
        FOR(d,s,10) {
            cur.push_back('0'+d);
            dfs(i+1,M,cur);
            cur.pop_back();
        }
    }    
    int superpalindromesInRange(string L, string R) {
        this-&gt;L=stoll(L),this-&gt;R=stoll(R);
//        dump2(L,R);
        FOR(M,1,10) {
            string s;
            dfs(0,M,s);
        }
        return SZ(S);
    }
};
// 19:41 &quot;1&quot;,&quot;2&quot; to be 1
// 19:47 &quot;4&quot;,&quot;1000&quot; to be 4
</PRE>
</BODY>
</HTML>
