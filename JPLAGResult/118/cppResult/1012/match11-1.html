<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>54_xieofxie.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>54_xieofxie.cpp</CENTER></H3><HR>
<PRE>
class Solution {
public:
    string bad(const tuple&lt;int, string, string&gt;&amp; s, const tuple&lt;int, string, string&gt;&amp; t){
        string stemp = get&lt;1&gt;(s);
        while (stemp.size() &lt; get&lt;1&gt;(t).size() + get&lt;2&gt;(s).size() * get&lt;2&gt;(t).size()) {
            stemp += get&lt;2&gt;(s);
        }
        return stemp;
    }
    bool isRationalEqual(string S, string T) {
        auto s = separate(S);
        auto t = separate(T);
        if (get&lt;0&gt;(s) != get&lt;0&gt;(t)) return false;
        if ((get&lt;2&gt;(s).empty() + get&lt;2&gt;(t).empty())%2 == 1) return false;
        if (get&lt;2&gt;(s).empty()) return get&lt;1&gt;(s) == get&lt;1&gt;(t);
        // bad
        const string stemp = bad(s, t), ttemp = bad(t, s);
        for (int i = 0;i &lt; stemp.size() &amp;&amp; i &lt; ttemp.size();++i) {
            if (stemp[i] != ttemp[i]) return false;
        }
        return true;
    }
    tuple&lt;int, string, string&gt; separate(const string&amp; S){
        tuple&lt;int, string, string&gt; result;
        auto&amp; result0 = get&lt;0&gt;(result);
        auto&amp; result1 = get&lt;1&gt;(result);
        auto&amp; result2 = get&lt;2&gt;(result);
        auto p = S.find('.');
        if (p == string::npos) {
            result0 = stoi(S);
            //cout &lt;&lt; result0 &lt;&lt; &quot;-&quot; &lt;&lt; result1 &lt;&lt; &quot;-&quot; &lt;&lt; result2 &lt;&lt; endl;
            return result;
        } else {
            result0 = stoi(S.substr(0, p));
        }
        auto p2 = S.find('(');
        if (p2 == string::npos) {
            result1 = S.substr(p + 1);
            while(result1.back() == '0') result1.pop_back();
            //cout &lt;&lt; result0 &lt;&lt; &quot;-&quot; &lt;&lt; result1 &lt;&lt; &quot;-&quot; &lt;&lt; result2 &lt;&lt; endl;
            return result;
        }
        // check 9
        if (p2 != p + 1) {
            result1 = S.substr(p + 1, p2 - p - 1);
        }
        bool all9 = true;
        for (int i = p2 + 1;i &lt; S.size() - 1;++i) {
            if (S[i] != '9') {
                all9 = false;
                break;
            }
        }
        if (all9) {
            if (result1.empty()) {
<A NAME="0"></A>                result0 += 1;
            } else {
                int carry = 1;
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match11-0.html#0',2,'match11-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>                for (int i = (int)result1.size() - 1;i &gt;= 0;--i) {
                    result1[i] += carry;
                    if (result1[i] &gt; '9') {
                        carry = 1;
                        result1[i] = '0';
                    } else {
                        carry = 0;
                    }
                }</B></FONT>
                if (carry == 1) {
                    result1 = &quot;&quot;;
                    result0 += 1;
                }
            }
        } else {
            result2 = S.substr(p2 + 1, S.size() - p2 - 2);
            if (stoi(result2) == 0) {
                result2 = &quot;&quot;;
                while(result1.back() == '0') result1.pop_back();
            }
        }
        //cout &lt;&lt; result0 &lt;&lt; &quot;-&quot; &lt;&lt; result1 &lt;&lt; &quot;-&quot; &lt;&lt; result2 &lt;&lt; endl;
        return result;
    }
};
</PRE>
</BODY>
</HTML>
