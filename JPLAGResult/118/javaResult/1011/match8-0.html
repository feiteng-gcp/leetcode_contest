<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>466_LindaBB.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>466_LindaBB.java</CENTER></H3><HR>
<PRE>
/**
 * Definition for a binary tree node.
 * public class TreeNode {
 *     int val;
 *     TreeNode left;
 *     TreeNode right;
 *     TreeNode(int x) { val = x; }
 * }
<A NAME="0"></A> */
class Solution {
        
    private int tryMatch(TreeNode root, <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match8-1.html#0',3,'match8-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>List&lt;Integer&gt; flips, int[] voyage, int idx) {
        if (root == null || idx &gt;= voyage.length || root.val != voyage[idx]) { return -1; }
        if (root.left == null &amp;&amp; root.right == null) {
<A NAME="1"></A>            return 1;
        }</B></FONT> else if (root.left == null) {
            int rightSize = tryMatch(root.right, flips, voyage, idx + 1);
            if (rightSize &gt;= 0) <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match8-1.html#1',3,'match8-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>{
                return 1 + rightSize;
            } else {
                return -1;
            }
        }</B></FONT> else if (root.right == null) {
            int leftSize = tryMatch(root.left, flips, voyage, idx + 1);
            if (leftSize &gt;= 0) {
                return 1 + leftSize;
            } else {
                return -1;
            }
        } else {
            if (idx + 1 &lt; voyage.length &amp;&amp; root.left.val == voyage[idx + 1]) {
                int leftSize = tryMatch(root.left, flips, voyage, idx + 1);
                if (leftSize &lt; 0) { return -1; }
                int rightSize = tryMatch(root.right, flips, voyage, idx + 1 + leftSize);
                if (rightSize &lt; 0) { return -1; }
                return leftSize + rightSize + 1;
            } else if (idx + 1 &lt; voyage.length &amp;&amp; root.right.val == voyage[idx + 1]) {
                flips.add(root.val);
                TreeNode temp = root.left;
                root.left = root.right;
                root.right = temp;
                int leftSize = tryMatch(root.left, flips, voyage, idx + 1);
                if (leftSize &lt; 0) { return -1; }
                int rightSize = tryMatch(root.right, flips, voyage, idx + 1 + leftSize);
                if (rightSize &lt; 0) { return -1; }
                return leftSize + rightSize + 1;
            } else {
                return -1;
            }
        }
    }
    
    public List&lt;Integer&gt; flipMatchVoyage(TreeNode root, int[] voyage) {
        
        List&lt;Integer&gt; flips = new ArrayList&lt;&gt;();
        
        // empty preorder
        if (voyage == null || voyage.length == 0) {
            flips.add(-1);
            return flips;
<A NAME="2"></A>        }
        
        // try to match the preorder
        <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match8-1.html#2',3,'match8-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if (tryMatch(root, flips, voyage, 0) &lt; 0) {
            flips.clear();
            flips.add(-1);
        }
        return flips;
        
    }</B></FONT>
}
</PRE>

</BODY>
</HTML>
