<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>108_y119777.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>108_y119777.cpp</CENTER></H3><HR>
<PRE>
<A NAME="1"></A>class Solution {
public:
<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match7-0.html#1',2,'match7-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>    vector&lt;int&gt; sortItems(int n, int m, vector&lt;int&gt;&amp; g, vector&lt;vector&lt;int&gt;&gt;&amp; a) {
    //for (int i = 0; i &lt;= n; i++) f[i] = i;
    // same process for -1
    for (int i = 0; i &lt; n; i++) {
    	if(g[i] == -1) {
    		g[i] = m++;
    	}
    }
    vector&lt;vector&lt;int&gt;&gt; ga(m);</B></FONT>
    for (int i = 0; i &lt; n; i++) {
    	ga[g[i] ].push_back(i);
    }
    vector&lt;vector&lt;int&gt;&gt; e1(n), e2(m);
    for (int i = 0; i &lt; n; i++) {
    	for (int x : a[i]) {
	    	if(g[x ] == g[i ]) {
	    		e1[x].push_back(i);
	    	} else {
	    		e2[g[x]].push_back(g[i]);
	    	}
	    }
    }
    //cout &lt;&lt; &quot;asd&quot; &lt;&lt; endl;
    std::vector&lt;int&gt; cnt(m);
    for (int x : g)
<A NAME="0"></A>    	++cnt[x];
    //check
    //cout &lt;&lt; &quot;aa&quot; &lt;&lt; endl;
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match7-0.html#0',2,'match7-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>    vector&lt;int&gt; du(m);
    for (int i = 0; i &lt; m; i++) {
    	for (int t : e2[i]) {
    		++du[t];
    	}
    }</B></FONT>
    vector&lt;int&gt; res;
    vector&lt;int&gt; du1(n);
    //vector&lt;int&gt; la;

    while(true) {
    	int t = -1;
    	for (int i = 0; i &lt; m; i++) {
    		if(du[i] == 0) {
    			du[i] = -1;
    			t = i;
    			break;
    		}
    	}
    	//cout &lt;&lt; t &lt;&lt; endl;
    	if(t == -1) break;

    	for (int x : e2[t])
    		--du[x];
    	if(t &gt;= n) {
    		if(!ga[t].empty())
    			res.push_back(ga[t][0]);
    		continue;
    	}
    	// in group
    	

    	if(ga[t].empty()) continue;
    	for (int x : ga[t]) {
    		for (int y : e1[x]) {
    			++du1[y];
    		}
    	}
    	int c = ga[t].size();
    	while(c &gt; 0) {
    		int td = -1;
    		for (int x : ga[t]) {
    			if(du1[x] == 0) {
    				td = x;
    				du1[x] = -1;
    				break;
    			}
    		}
			//cout &lt;&lt; &quot;in &quot; &lt;&lt; td &lt;&lt; endl;	

    		if(td == -1) break;
    		res.push_back(td);
    		--c;
    		for (int x : e1[td]) {
    			--du1[x];
    		}
    	}
    	if(c != 0) break;


    }
    if(res.size() != n)
    	res.clear();
    return res;
}
};
</PRE>
</BODY>
</HTML>
