<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>73_luchy0120.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>73_luchy0120.java</CENTER></H3><HR>
<PRE>
class Solution {
    public int[] sortItems(int n, int m, int[] group, List&lt;List&lt;Integer&gt;&gt; bs) {
        int[] all = new int[n];
        int fk = 0;
        
        
        Set gnode[] = new Set[m+1];
        Set gnodeg[] = new Set[m+1];
        int in[] = new int[m+1];
        for(int i=0;i&lt;m+1;++i){
            gnode[i] = new HashSet();
            gnodeg[i] = new HashSet();
        }
        for(int i=0;i&lt;n;++i){
            if(group[i]==-1){
                group[i] = m;
            }   
        }
<A NAME="0"></A>        
        for(int i=0;i&lt;n;++i){
            gnode[group[i]].add(i);
            <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match14-1.html#0',3,'match14-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>for(int u:bs.get(i)){
                int other = group[u];
                if(other!=group[i]){
                gnodeg[other].add(group[i]);
                }
            }
        }
        
        for(int i=0;i&lt;m+1;++i){</B></FONT>
            for(Object u:gnodeg[i]){
                int go = (int)u;
                in[go]++;
                
            }
        }
        Queue&lt;Integer&gt; q = new ArrayDeque&lt;&gt;();
        for(int i=0;i&lt;m+1;++i){
            if(in[i]==0){
                q.offer(i);
                //System.out.println(i);
            }
        }
        int sx[] = new int[m+1];int p =0;
        
        while(q.size()&gt;0){
            
            int c = q.poll(); 
            sx[p++] = c;
            for(Object go:gnodeg[c]){
                    int out = (int) go;
                    in[out]--;
                    if(in[out]==0){
                        q.offer(out);
<A NAME="1"></A>                    }
            }
        }
        <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match14-1.html#1',3,'match14-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if(p&lt;m+1){
            return new int[0];
        }
        
            List[] gg = new List[n];
            int[] ini = new int[n]</B></FONT>;
            for(int i=0;i&lt;n;++i){
                gg[i] = new ArrayList();
            }
        
        
        for(int vv:sx){
           // System.out.println(vv);
            
            Set me = gnode[vv];
            
            for(Object y:me){
                gg[(int)y] = new ArrayList();  
                ini[(int)y] = 0;
            }
            
            
            for(Object y:me){
                int yo = (int) y;
            for(int u:bs.get(yo)){
                if(me.contains(u)){
                    gg[u].add(yo);
                    ini[yo]++;
                }
            }
            }
            
            
            
<A NAME="2"></A>        Queue&lt;Integer&gt; qq = new ArrayDeque&lt;&gt;();
        for(Object i:me){
            if(ini[(int)i]==0){
                <FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match14-1.html#2',3,'match14-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>qq.offer((int)i);
            }
        }
            
            
            
            
        while(qq.size()&gt;0){
            int c = qq.poll</B></FONT>(); 
            all[fk++]=c;
            for(Object go:gg[c]){
                    int out = (int) go;
                    ini[out]--;
                    if(ini[out]==0){
                        qq.offer(out);
                    }
            }
        }
            
            
            
            
            
            
            
            
        }
        
         if(fk&lt;n){
            return new int[0];
        }
        
        
        return all;
        
        
        
        
        
        
        
    }
}
</PRE>

</BODY>
</HTML>
