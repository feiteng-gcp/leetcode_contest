<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>289_Bellerophon.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>289_Bellerophon.java</CENTER></H3><HR>
<PRE>
<A NAME="0"></A><FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match21-0.html#0',2,'match21-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>class Solution {
    public int nthUglyNumber(int n, int a, int b, int c) {
        
        long left = 1;
        long right = 2 * 1_000_000_009;
        
        long gcd1 = gcd(a, b);
        long gcd2 = gcd(b, c)</B></FONT>;
        long gcd3 = gcd(a, c);
        long gcd4 = gcd(gcd1, gcd2);
<A NAME="1"></A>        
        long lcm1 = (long)a * (long)b / gcd1;
        long lcm2 = (long)b * (long)c / gcd2;
        <FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match21-0.html#1',2,'match21-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>long lcm3 = (long)a * (long)c / gcd3;
        long gcd5 = gcd(lcm1, lcm2);
        long lcm4 = lcm1 / gcd5 * (lcm2 / gcd5) * gcd5;
        
        // System.out.println(lcm1);
        // System.out.println(lcm2);
        // System.out.println(lcm3);
        // System.out.println(lcm4);
        
        
        while(left &lt; right - 1)
        {
            long mid = left + (right - left) / 2;
            long cnt = getCnt(mid, a, b, c, lcm1, lcm2, lcm3, lcm4);
            
            if(cnt &gt;= n)
                right = mid;
            else
                left = mid;
        }</B></FONT>
        
        if(getCnt(left, a, b, c, lcm1, lcm2, lcm3, lcm4) == n)
            return (int)left;
        
<A NAME="3"></A>        return (int)right;
    }
    
<A NAME="2"></A>    <FONT color="#6cc417"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match21-0.html#3',2,'match21-top.html#3',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>private long getCnt(long target, int a, int b, int c, long lcm1, long lcm2, long lcm3, long lcm4)
    {
        return</B></FONT> target/a + target/b + target/c - (lcm1 &gt; 0 ? target/lcm1 : 0) - (lcm2 &gt; 0 ? target/lcm2 : 0) - (lcm2 &gt; 0 ? target/lcm3 : 0) + (lcm2 &gt; 0 ? target/lcm4 : 0); 
    <FONT color="#77bfc7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match21-0.html#2',2,'match21-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>}
    
    private long gcd(long a, long b)
    {
        if(a == 0)
            return b;
        return gcd(b % a, a);
    }</B></FONT>
}
</PRE>

</BODY>
</HTML>
