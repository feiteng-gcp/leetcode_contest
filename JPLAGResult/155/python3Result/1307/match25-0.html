<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>61_HanBurger.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>61_HanBurger.py</CENTER></H3><HR>
<PRE>
class Solution:
    def nthUglyNumber(self, n: int, a: int, b: int, c: int) -&gt; int:
        return self.binarysearch(n, a, b, c)
    
    def binarysearch(self, n, a, b, c):
        def gcd(a, b):
            if a &lt; b:
                return gcd(b, a)
            if a % b == 0:
                return b
            return gcd(b, a % b)
        
        def lcm(a, b):
            return a * b // gcd(a, b)
        
        gcdab = gcd(a, b)
        gcdbc = gcd(b, c)
        gcdac = gcd(a, c)
        gcdabc = gcd(gcdab, gcdbc)
        lcmab = a * b // gcdab
        lcmbc = b * c // gcdbc
        lcmac = a * c // gcdac
        lcmabc = lcm(a, lcm(b, c))
        
        # print(gcdab, gcdbc, gcdac ,gcdabc, lcmab, lcmbc, lcmac, lcmabc, a, b, c)
        
        def num_le(x):
            nonlocal lcmab, lcmbc, lcmac, lcmabc, a, b, c
<A NAME="0"></A>            res = (x // a) + (x // b) + (x // c) + (x // lcmabc) - (x // lcmab) - (x // lcmbc) - (x // lcmac)
            return res
        
        l, r <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match25-1.html#0',3,'match25-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>= 1, 2 * (10 ** 9)
        while l &lt; r:
            m = (l + r) // 2
            if num_le(m) &lt; n:
                l = m + 1
            else:
                r = m
        return l
        
        
<A NAME="1"></A>    def</B></FONT> regular(self, n, a, b, c):
        a, b, c = tuple(sorted(a, b, c))
        ac, bc, cc = 1, 1, 1
        r <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match25-1.html#1',3,'match25-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>= 1
        for i in range(n):
            r = min(a * ac, b * bc, c * cc)
            if r == a * ac:
                ac += 1
            if r == b * bc:
                bc += 1
            if r == c * cc:
                cc += 1
        return</B></FONT> r
</PRE>

</BODY>
</HTML>
