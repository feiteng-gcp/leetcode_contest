<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>128_y119777.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>128_y119777.cpp</CENTER></H3><HR>
<PRE>
  int dp[10][260];
class Solution {
public:
  
int maxStudents(vector&lt;vector&lt;char&gt;&gt;&amp; s) {
<A NAME="0"></A>    int n = s.size();
    int m = s[0].size();
    vector&lt;int&gt; p;
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match38-0.html#0',2,'match38-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>    for (int i = 0; i &lt; (1 &lt;&lt; m); i++) {
    	bool f = 1;
    	for (int j = 1; j &lt; m; j++) {
    		if(((1 &lt;&lt; j) &amp; i) &amp;&amp; (i &amp; (1 &lt;&lt; (j - 1)))) {
    			f = 0; break;
    		}
    	}
    	if (f) p.push_back(i);</B></FONT>
    }
    memset(dp, -1, sizeof dp);
    auto ok = [&amp;](int x, int y) {
    	//bool f = 1;
    	for (int i = 0; i &lt; m; i++) {
    		if(x &amp; (1 &lt;&lt; i)) {
    			if(i - 1 &gt;= 0 &amp;&amp; (y &amp; (1 &lt;&lt; (i - 1))))
    				return false;
    			if(i + 1 &lt; m &amp;&amp; (y &amp; (1 &lt;&lt; (i + 1))))
    				return false;
    		}
    	}
    	return true;
    };
<A NAME="1"></A>    for (int i = 1; i &lt;= n; i++) {
    	if (i == 1) {
    		for (int j = 0; j &lt; p.size(); j++) {
<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match38-0.html#1',2,'match38-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>    			bool f = 1;
    			for (int k = 0; k &lt; m; k++) {
    				if ((p[j] &amp; (1 &lt;&lt; k)) &amp;&amp; s[i - 1][k] == '#') {
    					f = 0; break;
    				}
    			}
    			if (f) dp[i][p[j]] = __builtin_popcount(p[j]);</B></FONT>
    		}
    	} else {
    		for (int j = 0; j &lt; p.size(); j++) {
    			bool f = 1;
    			for (int k = 0; k &lt; m; k++) {
    				if ((p[j] &amp; (1 &lt;&lt; k)) &amp;&amp; s[i - 1][k] == '#') {
    					f = 0; break;
    				}
    			}
    			if (!f) continue;
    			int v = -1;
    			for (int k = 0; k &lt; p.size(); k++) {
    				if(dp[i - 1][p[k]] == -1) continue;
    				if (!ok(p[j], p[k])) continue;
    				if (v == -1 || v &lt; dp[i - 1][p[k]])
    					v = dp[i - 1][p[k]];
    			}
    			dp[i][p[j]] = __builtin_popcount(p[j]) + v;
    		}
    	}
    }
    int res = 0;
    for (int i = 0; i &lt; p.size(); i++) {
    	res = max(res, dp[n][p[i]]);
    }
    return res;
}
};
</PRE>
</BODY>
</HTML>
