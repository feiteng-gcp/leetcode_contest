<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>127_ForGive.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>127_ForGive.cpp</CENTER></H3><HR>
<PRE>
<A NAME="0"></A>const int MAXVAL = 1000000;
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match7-0.html#0',2,'match7-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>class Solution {

const int dx[4] = {1, 0, -1, 0};
const int dy[4] = {0, 1, 0, -1};</B></FONT>
    bool isvalid(int i, int j)
    {
        return i &gt;= 0 &amp;&amp; j &gt;= 0 &amp;&amp; i &lt; MAXVAL &amp;&amp; j &lt; MAXVAL;
    }
    
    struct hash
    {
      std::size_t operator()(const std::pair&lt;int,int&gt;&amp; p) const
      {
        return p.first*203 + p.second;
      }
    };
    
public:
    bool isEscapePossible(vector&lt;vector&lt;int&gt;&gt;&amp; blocked, vector&lt;int&gt;&amp; s, vector&lt;int&gt;&amp; t) {
        unordered_set&lt;pair&lt;int, int&gt;, hash&gt; b;
        
        for(auto&amp; v: blocked)
        {
            b.insert({v[0], v[1]});
        }
        
        if(canGoOut(b, s[0], s[1], t[0], t[1]) &amp;&amp;
           canGoOut(b, t[0], t[1], s[0], s[1]))
            return true;
        return false;
    }
    
    bool canGoOut(unordered_set&lt;pair&lt;int, int&gt;, hash&gt;&amp; b, int i, int j, int ti, int tj)
    {
        int mx = 4000;
        int cnt = 0;
        queue&lt;pair&lt;int, int&gt;&gt; q;
        q.push({i, j});
        unordered_set&lt;pair&lt;int, int&gt;, hash&gt; used;
        
        while(!q.empty() &amp;&amp; cnt &lt; mx)
        {
            cnt++;
            
            i = q.front().first;
<A NAME="1"></A>            j = q.front().second;
            q.pop();
            
<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match7-0.html#1',2,'match7-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>            if(i == ti &amp;&amp; j == tj) return true;
            
            for(int d = 0; d &lt; 4; d++)
            {
                int ii = dx[d] + i;
                int jj = dy[d] + j;
                
                if(isvalid(ii, jj) &amp;&amp; b.find({ii, jj}) == b.end() &amp;&amp; used.find({ii, jj}) == used.end())</B></FONT>
                {
                    used.insert({ii, jj});
                    q.push({ii,jj});
                }
            }
        }
        
        return !q.empty();
    }
};
</PRE>
</BODY>
</HTML>
