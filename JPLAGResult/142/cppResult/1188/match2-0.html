<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>72_democoffee.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>72_democoffee.cpp</CENTER></H3><HR>
<PRE>
<A NAME="0"></A>class Solution {
public:
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match2-1.html#0',3,'match2-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>    vector&lt;string&gt; flatten(vector&lt;vector&lt;string&gt;&gt; &amp;in) {
        unordered_set&lt;string&gt; hs; 
        for (auto &amp;&amp;vs: in) {
            for (auto &amp;&amp;s: vs) {
                hs.emplace(s);
            }   
        }   
        return move(vector&lt;string&gt;(hs.begin(), hs.end()));
    }   

    vector&lt;string&gt; merge2(vector&lt;string&gt; &amp;vs1, vector&lt;string&gt; &amp;vs2) {</B></FONT>
        vector&lt;string&gt; ret;
        for (auto &amp;s1: vs1) {
            for (auto &amp;s2: vs2) {
                ret.emplace_back(move(s1 + s2));
            }   
        }   
        return ret;
    }   

    vector&lt;string&gt; dfs(string &amp;exp, int &amp;cur) {
        vector&lt;vector&lt;string&gt;&gt; tmp;
        bool merge = true;
        for (; cur&lt;exp.length(); ++cur) {
            vector&lt;string&gt; ret;
            if (exp[cur] == ',') {
                merge = false;
                continue;
            } else if (exp[cur] == '}') {
                break;
            } else if (exp[cur] == '{') {
                ++cur;
                vector&lt;string&gt; sub;
                ret = move(dfs(exp, cur));
            } else {
                ret = vector&lt;string&gt; { string(1, exp[cur]) };
            }   
            if (merge) {
                int len = tmp.size();
                if (len == 0) {
                    tmp.emplace_back(move(ret));
                } else {
                    tmp[len-1] = move(merge2(tmp[len-1], ret));
                }   
            } else {
                tmp.emplace_back(move(ret));
            }   
            merge = true;
        }   

        auto ss = move(flatten(tmp));
        sort(ss.begin(), ss.end());
        return ss; 
    }   

    vector&lt;string&gt; braceExpansionII(string expression) {
        int cur = 0;
        return dfs(expression, cur);
    }   
};
</PRE>
</BODY>
</HTML>
