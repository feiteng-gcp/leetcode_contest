<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>446_zijia_x.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>446_zijia_x.cpp</CENTER></H3><HR>
<PRE>
class Solution {
private:
    int strToInt(string str) {
        if (str.empty()) {
            return -1;
        }
        
        if (str[0] == '0') {
            if (str.length() == 1) {
                return 0;
            } else {
                return -1;
            }
        }
        
        long long result = 0;
        
        for (int i = 0; i &lt; str.length(); ++i) {
            result = result * 10 + (str[i] - '0');
            
            if (result &gt;= pow(2, 31)) {
                return -1;
            }
        }
        return (int)result;
    }
    
    int getIntDigitCnt(int num) {
        if (num &lt; 0) {
            return -1;
        }
        
        if (num == 0) {
            return 1;
        }
        
        int result = 0;
        
        while (num &gt; 0) {
            num /= 10;
            ++result;
        }
        return result;
    }
    
    void helper(string str, int first_idx, int first_length, vector&lt;int&gt; &amp;result) {
        string first_str = str.substr(first_idx, first_length);
        int first = strToInt(first_str);
        if (first &lt; 0) {
            return;
        }
<A NAME="0"></A>        int second_idx = first_idx + first_length;
        if (second_idx &gt; str.size() - 1) {
            return;
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match15-1.html#0',3,'match15-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>        }
        
        for (int i = 1; i &lt; str.length(); ++i) {
            int second_length = i;
            if (first_length + second_length &gt; str.length()) {
                break;
            }</B></FONT>
            string second_str = str.substr(second_idx, second_length);
            int second = strToInt(second_str);
            if (second &lt; 0) {
                continue;
            }            
            int third_idx = second_idx + second_length;
            if (third_idx &gt; str.size() - 1) {
               break;
            }
            long long third = first + second;
            if (third &gt;= pow(2, 31)) {
                continue;
            }
            int third_length = getIntDigitCnt(int(third));
            if (first_length + second_length + third_length &gt; str.length()) {
                break;
            }
            string third_str = str.substr(third_idx, third_length);
            int third_target = strToInt(third_str);
            
            if ((int)third == third_target) {
                
            /*if ((first_length == 1) &amp;&amp; (second_length == 1)) {
                cout &lt;&lt; &quot;first_idx: &quot; &lt;&lt; first_idx &lt;&lt; endl;
                cout &lt;&lt; &quot;first_length: &quot; &lt;&lt; first_length &lt;&lt; endl;
                cout &lt;&lt; &quot;first_str: &quot; &lt;&lt; first_str &lt;&lt; endl;
                cout &lt;&lt; &quot;first: &quot; &lt;&lt; first &lt;&lt; endl;
                cout &lt;&lt; &quot;second_idx: &quot; &lt;&lt; second_idx &lt;&lt; endl;
                cout &lt;&lt; &quot;second_length: &quot; &lt;&lt; second_length &lt;&lt; endl;
                cout &lt;&lt; &quot;second_str: &quot; &lt;&lt; second_str &lt;&lt; endl;
                cout &lt;&lt; &quot;second: &quot; &lt;&lt; second &lt;&lt; endl;
                cout &lt;&lt; &quot;third_idx: &quot; &lt;&lt; third_idx &lt;&lt; endl;
                cout &lt;&lt; &quot;third_length: &quot; &lt;&lt; third_length &lt;&lt; endl;
                cout &lt;&lt; &quot;third_str: &quot; &lt;&lt; third_str &lt;&lt; endl;
                cout &lt;&lt; &quot;third: &quot; &lt;&lt; third &lt;&lt; endl &lt;&lt; endl;
            }*/

                if (first_length + second_length + third_length &lt; str.length()) {
                    result.push_back(first);
                    
                    string next_str = str.substr(second_idx, str.size() - first_length);
                    vector&lt;int&gt; next_result = splitIntoFibonacci(next_str);
                    
                    if (next_result.empty()) {
                        result.pop_back();
                    } else {
                        if (next_result.size() &gt;= 2 &amp;&amp; next_result[0] == second &amp;&amp; next_result[1] == third_target) {
                        for (int j = 0; j &lt; next_result.size(); ++j) {
                            result.push_back(next_result[j]);
                        }
                        break;
                        } else {
                            result.pop_back();
                        }
                    }
                } else if (first_length + second_length + third_length == str.length()) {
                    result.push_back(first);
                    result.push_back(second);
                    result.push_back(third_target);
                    break;
                }
            }
        }
    }
    
public:
    vector&lt;int&gt; splitIntoFibonacci(string str) {
        int n = str.length();
        vector&lt;int&gt; result;
        
        if (n &lt; 3) {
            return result;
        }
        
        for (int i = 1; i &lt; str.size(); ++i) {
            helper(str, 0, i, result);
            if (!result.empty()) {
                break;
            }
        }
        
        return result;
    }
};
</PRE>
</BODY>
</HTML>
