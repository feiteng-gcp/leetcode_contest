<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>368_lirongbin.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>368_lirongbin.java</CENTER></H3><HR>
<PRE>
class Solution {
<A NAME="0"></A>    private static final long limit = (1L &lt;&lt; 31) -1;
    
    private List&lt;Integer&gt; tryAns(String S, int i, int j) {
        <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match28-1.html#0',3,'match28-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>long f1 = Long.parseLong(S.substring(0, i+1));
        long f2 = Long.parseLong(S.substring(i+1, j+1));
        List&lt;Integer&gt; fib = new ArrayList&lt;&gt;();
        fib.add((int) f1);
        fib.add((int) f2);
        int k = j+1;
        while (k &lt; S.length</B></FONT>()) {
            long f3 = f1 + f2;
            if (f3 &gt; limit) {
                return new ArrayList&lt;&gt;();
            }
            String f3str = String.valueOf(f3);
            if (k + f3str.length() &gt; S.length()) {
                return new ArrayList&lt;&gt;();
            }
            if (!f3str.equals(S.substring(k, k+f3str.length()))) {
                return new ArrayList&lt;&gt;();
            }
            fib.add((int) f3);
            k += f3str.length();
            f1 = f2;
            f2 = f3; 
        }
        return fib;
    }
    
    public List&lt;Integer&gt; splitIntoFibonacci(String S) {
        final int n = S.length();
        long first = 0;
        for (int i=0; i&lt;n-1 &amp;&amp; first*10+(S.charAt(i)-'0') &lt; limit &amp;&amp; (first &gt; 0 || i==0); i++) {
            
            first = first*10+(S.charAt(i)-'0');
            
            System.out.println(&quot;i=&quot; + i + &quot; first = &quot; + first);
            
            long second = 0;
            for (int j=i+1; j&lt;n-1 &amp;&amp; (second&gt;0 || j==i+1) &amp;&amp; second*10+(S.charAt(j)-'0') &lt; limit; j++) {
                second = second*10+(S.charAt(j)-'0');
                List&lt;Integer&gt; tans= tryAns(S, i, j);
                if (tans.size() &gt; 0) {
                    return tans;
                }
            }
        }
        return new ArrayList&lt;&gt;();
    }
}
</PRE>

</BODY>
</HTML>
