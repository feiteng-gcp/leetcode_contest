<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>25_Kmcode.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>25_Kmcode.cpp</CENTER></H3><HR>
<PRE>

struct MAX_BIT {
	vector&lt;pair&lt;long double,int&gt; &gt; bit;
	void resize(int N) {
		bit.assign(N + 10, make_pair(INT_MIN, INT_MIN));
	}
	void add(int i, pair&lt;long double,int&gt; j) {
		i++;
		while (i &lt; bit.size()) {
			bit[i] = max(bit[i], j);
			i += i &amp; -i;
		}
	}
	pair&lt;long double, int&gt; sum(int i) {
		pair&lt;long double, int&gt; r = make_pair( INT_MIN,INT_MIN );
		i++;
		while (i) {
			r = max(r, bit[i]);
			i -= i &amp; -i;
		}
		return r;
	}
};
struct MAX_BIT2 {
	vector&lt;pair&lt;long double,int&gt; &gt; bit;
	void resize(int N) {
		bit.assign(N + 10, make_pair(INT_MIN, INT_MIN));
	}
	void add(int i, pair&lt;long double, int&gt; j) {
		i = bit.size() - i - 2;
		while (i &lt; bit.size()) {
			bit[i] = max(bit[i], j);
			i += i &amp; -i;
		}
	}
	pair&lt;long double, int&gt; sum(int i) {
		pair&lt;long double, int&gt; r = make_pair(INT_MIN,INT_MIN );
		i = bit.size() - i - 2;
		while (i) {
			r = max(r, bit[i]);
			i -= i &amp; -i;
		}
		return r;
	}
};
class Solution {
public:
	bool dp[20002][2];
	MAX_BIT b;
	MAX_BIT2 rb;
	int oddEvenJumps(vector&lt;int&gt;&amp; A) {
		memset(dp, false, sizeof(dp));
		b.resize(100005);
		rb.resize(100005);
		for (int i = A.size() - 1; i &gt;= 0; i--) {
			for (int j = 0; j &lt; 2; j++) {
				if (i == A.size() - 1) {
					dp[i][j] = true;
				}
				else {
					if (j == 0) {
						auto go = rb.sum(A[i]);
						if (go.first != INT_MIN) {
							go.second = -go.second;
							dp[i][j] = dp[go.second][j ^ true];
						}
					}
					else {
						auto go = b.sum(A[i]);
						if (go.first != INT_MIN) {
							go.second = -go.second;
							dp[i][j] = dp[go.second][j ^ true];
<A NAME="0"></A>						}
					}
				}
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match36-0.html#0',2,'match36-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>			}
			b.add(A[i], make_pair(A[i],-i));
			rb.add(A[i], make_pair(-A[i],-i));
		}
		int cnt = 0;
		for (int i = 0; i &lt; A.size(); i++) {
			if (dp[i][0] == true) {
				cnt++;
			}
		}

		return  cnt;
	}
};</B></FONT>
</PRE>
</BODY>
</HTML>
