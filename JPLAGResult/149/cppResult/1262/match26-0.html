<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>89_rzwei.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>89_rzwei.cpp</CENTER></H3><HR>
<PRE>
class MajorityChecker {
public:
	vector&lt;map&lt;int, int&gt;&gt; cnt;
	int n;
	map&lt;int, vector&lt;int&gt;&gt; idx;
	vector&lt;vector&lt;int&gt;&gt; order;
	MajorityChecker(vector&lt;int&gt;&amp; a) : n(a.size()) {
		for (int i = 0; i &lt; n; ++i)
		{
			idx[a[i]].push_back(i);
		}
		for (auto&amp; e : idx)
		{
			e.second.push_back(e.first);
			order.push_back(e.second);
		}
		sort(order.begin(), order.end(), [](const vector&lt;int&gt;&amp; a, const vector&lt;int&gt;&amp; b) {
			return a.size() &lt; b.size(); });
	}
	int count(int v, vector&lt;int&gt;&amp; a)
	{
		auto it = lower_bound(a.begin(), a.end() - 1, v);
		return it - a.begin();
	}
	int count2(int v, vector&lt;int&gt;&amp; a)
	{
<A NAME="0"></A>		auto it = upper_bound(a.begin(), a.end() - 1, v);
		return it - a.begin();
	}
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match26-1.html#0',3,'match26-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>	int query(int left, int right, int t) {
		int l = 0, r = order.size();
		while (l &lt; r)
		{
			int m = (l + r) / 2;
			if (order[m].size() &gt;= t)
			{
				r = m;
			}
			else</B></FONT>
			{
				l = m + 1;
<A NAME="1"></A>			}
		}
		if (l == order.size()) return -1;
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match26-1.html#1',3,'match26-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>		for (int i = l; i &lt; order.size(); ++i)
		{
			int tot = count2(right, order[i]) - count(left, order[i]);
			if (tot &gt;= t) return order[i].back();
		}
		return -1;
	}
};</B></FONT>
</PRE>
</BODY>
</HTML>
