<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>77_ZhongnianTao.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>77_ZhongnianTao.cpp</CENTER></H3><HR>
<PRE>
#define maxn 21111
int a[maxn];
int nxt[maxn];
int cnt[28][maxn];
int n;

class Solution {
public:
    
    bool check(int L,int R,int goal)
    {
        int len=R-L+1;
        int cg=cnt[goal][R]-cnt[goal][L-1];
        if (cg+1&lt;len) return false;
        int all_g=cnt[goal][n];
        if (cg+1==len &amp;&amp; cg==all_g) return false;
        return true;
    }
    
    int maxRepOpt1(string text) {
        memset(a,0,sizeof(a));
        memset(nxt,0,sizeof(nxt));
        memset(cnt,0,sizeof(cnt));
        
        n=text.length();
        for(int i=1;i&lt;=n;i++) a[i]=text[i-1]-'a'+1;
        
        for(int i=1;i&lt;=n;i++)
        {
            for(int j=1;j&lt;=26;j++)
            {
<A NAME="0"></A>                cnt[j][i]=cnt[j][i-1];
            }
            cnt[a[i]][i]++;
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match36-1.html#0',3,'match36-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>        }
        
        int ans=1;
        for(int p=1;p&lt;=26;p++)
        {
            for(int i=1;i&lt;=n;i++)
            {
                int lo=i+1,hi=n,mid;</B></FONT>
                while (lo+5&lt;hi)
                {
                    mid=(lo+hi)/2;
                    if (check(i,mid,p))
                    {
                        lo=mid;
                    }
                    else
                    {
                        hi=mid;
                    }
                }
                int ret=lo;
                for(int j=lo;j&lt;=hi;j++)
                {
                    if (check(i,j,p)) ret=j;
                }
                if (check(i,ret,p))
                {
                    ans=max(ans,ret-i+1);
                }
            }
        }
        
        return ans;
    }
};
</PRE>
</BODY>
</HTML>
