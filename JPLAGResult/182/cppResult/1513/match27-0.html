<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>97_Time-Limit.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>97_Time-Limit.cpp</CENTER></H3><HR>
<PRE>
const int64_t MOD = 1000000007;
inline void add(int64_t &amp;a, int64_t b) {
    a += b;
    if(a &gt;= MOD) {
        a %= MOD;
    }
}
class Solution {
public:
<A NAME="0"></A>    void get(const string &amp;s, const string &amp;evil, int n, int64_t &amp;sum, int64_t &amp;part) {
        int64_t dp[501][2][51] = {0};
        int m = evil.size();
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match27-1.html#0',3,'match27-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>        dp[0][1][0] = 1;
        for(int i = 0; i &lt; n; i++) {
            for(int j = 0; j &lt; 2; j++) {
                for(int k = 0; k &lt; m; k++) {</B></FONT>
                    for(char c = 'a'; c &lt;= 'z'; c++) {
                        int ni = i+1, nj = -1, nk = -1;
                        if(j == 1) {
                            if(c &gt; s[i]) {
                                break;
                            }
                            if(c == s[i]) {
                                nj = 1;
                            } else {
                                nj = 0;
                            }
                        } else {
                            nj = 0;
                        }
                        if(c == evil[k]) {
                            nk = k+1;
                        } else {
                            nk = 0;
<A NAME="1"></A>                            for(int p = 0; p &lt;= k; p++) {
                                int len = (k-p);
                                if(evil[len] != c) { continue; }
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match27-1.html#1',3,'match27-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>                                bool flag = true;
                                for(int q = 0; q &lt; len; q++) {
                                    if(evil[q] != evil[q+p]) { flag = false; break; }
                                }
                                if(flag) { nk = len+1; break;}
                            }
                        }</B></FONT>
                        if(nk == m) {
                            continue;
                        }
                        add(dp[ni][nj][nk], dp[i][j][k]);
                    }
                }
            }
        }
		sum = 0, part = 0;
        for(int i = 0; i &lt; m; i++) {
            add(sum, dp[n][0][i]);
            add(sum, dp[n][1][i]);
            add(part, dp[n][1][i]);
        }
		/*
        cout &lt;&lt; sum &lt;&lt; &quot; &quot; &lt;&lt; part &lt;&lt; endl;
        for(int i = 0; i &lt;= n; i++) {
            for(int j = 0; j &lt; 2; j++) {
                for(int k = 0; k &lt;= m; k++) {
                    cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; j &lt;&lt; &quot; &quot; &lt;&lt; k &lt;&lt; &quot; &quot; &lt;&lt; dp[i][j][k] &lt;&lt; endl;
                }
            }
        }
		*/
    }
    int findGoodStrings(int n, string s1, string s2, string evil) {
        if (s1 &gt; s2) {
            return 0;
        }
        int64_t sum1, part1;
        int64_t sum2, part2;
        get(s1, evil, n, sum1, part1);
        get(s2, evil, n, sum2, part2);
        return (sum2+part1-sum1+MOD)%MOD;
    }
};
</PRE>
</BODY>
</HTML>
