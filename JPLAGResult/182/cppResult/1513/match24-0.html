<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>88_is03wlei.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>88_is03wlei.cpp</CENTER></H3><HR>
<PRE>
class Solution {
public:
    
    int f[501][51][2];
    const int mo=1000000007;
    
    int c[51][26];
    
    void match(string eval) {
        int n=eval.length();
        //printf(&quot;match\n&quot;);
        for(int i=0;i&lt;n;i++){
            string tmp=eval;
                
            for(int j=0;j&lt;26;j++){
                tmp[i]='a'+j;
                
                for(int k=0;k&lt;i+1;k++){
                    int pre=0;
                    int p=k;
                    for(p=k;p&lt;i+1;p++) {
                        //printf(&quot;%d %d\n&quot;, tmp[p]-'a', eval[p-k]-'a');
                        if (tmp[p]!=eval[p-k])break;
                    }
                    if (p==i+1) {
                        c[i][j]=i+1-k;
                        //printf(&quot;match %d\n&quot;, c[i][j]);
                        break;        
                    }
                }
            }
        }
        
        //printf(&quot;end match\n&quot;);
    }
    
<A NAME="0"></A>    int dp(string s, string eval) {
        memset(f,0,sizeof(f));
        int n=s.length();
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match24-1.html#0',3,'match24-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>        int m=eval.length();
    
        // tie
        f[0][0][0]=1;
    
        for(int i=0;i&lt;n;i++){
            for(int j=0;j&lt;m&amp;&amp;j&lt;=i;j++){
                    
                // tie
                //int choice=s[i]-'a'+1;
                    
                // match eval[j]
                //if (eval[j]&lt;s[i]) f[i+1][j+1][1]+=f[i][j][0];
                //else if (eval[j]==s[i]) f[i+1][j+1][0]+=f[i][j][0];
                    
                for(int next=0;next&lt;=s[i]-'a';next++) {</B></FONT>
                    //if (next+'a'==eval[j]) continue;
                    int suf = c[j][next];
                    //printf(&quot;%d %d %d %d\n&quot;, i, j, next, suf); 
                    if (next&lt;s[i]-'a') {
                        f[i+1][suf][1]=(f[i+1][suf][1]+f[i][j][0])%mo;
                    } else {
                        f[i+1][suf][0]=(f[i+1][suf][0]+f[i][j][0])%mo;
                    }
                }
                    
                // not tie
                
                for(int next=0;next&lt;26;next++){
<A NAME="1"></A>                    int suf=c[j][next];
                    
                    //printf(&quot;%d %d %d %d\n&quot;, i, j, next, suf);
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match24-1.html#1',3,'match24-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>                    f[i+1][suf][1]=(f[i+1][suf][1]+f[i][j][1])%mo;
                }
                
            }
        }
        int ans=0;
        for(int j=0;j&lt;m;j++){
            ans=(ans+f[n][j][0])%mo;
            ans=(ans+f[n][j][1])%mo;
        }
        return ans;
    }</B></FONT>
    
    int findGoodStrings(int n, string s1, string s2, string evil) {
        match(evil);
        int a1=dp(s1, evil);
        
        int a2=dp(s2, evil);
        
        
        
        int ans=(a2-a1+mo)%mo;
        printf(&quot;%d %d %d\n&quot;, a1, a2, ans);
        if (strstr(s1.c_str(), evil.c_str())==NULL) {
            ans=(ans+mo+1)%mo;
        }
        return ans;
    }
};
</PRE>
</BODY>
</HTML>
