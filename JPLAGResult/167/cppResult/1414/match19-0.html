<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>406_lyk-ohlyk.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>406_lyk-ohlyk.cpp</CENTER></H3><HR>
<PRE>
typedef pair&lt;int, int&gt; PII;
typedef pair&lt;int, PII&gt; PIII;

struct Step{
    int cost;
    int dist;
    int x;
    int y;
    int cnt;
    Step() {};
    Step(int a, int b, int c, int d, int e) {
        cost = a;
        dist = b;
        x = c;
        y = d;
        cnt = e;
    }
};

bool operator&gt;(Step a, Step b) {
<A NAME="0"></A>    return a.cost &gt; b.cost;
}

<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match19-1.html#0',3,'match19-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>int dx[4] = {0, 1, 0, -1};
int dy[4] = {1, 0, -1, 0};

class Solution {
public:
    int shortestPath(vector&lt;vector&lt;int&gt;&gt;&amp; grid, int k) {
        priority_queue&lt;Step, vector&lt;Step&gt;, greater&lt;Step&gt;&gt; heap;
        int n = grid.size();
        int m = grid[0].size();
        
        vector&lt;vector&lt;unordered_set&lt;int&gt;&gt;&gt; st(n, vector&lt;unordered_set&lt;int&gt;&gt;(m));</B></FONT>
        
        if (grid[0][0] == 1) 
            heap.push({n - 1 + m - 1, 0, 0, 0, 1});
        else
            heap.push({n + m - 2, 0, 0, 0, 0});
        st[0][0].insert(0);
        
        while (!heap.empty()) {
            Step cur = heap.top();
            heap.pop();
            int x = cur.x;
            int y = cur.y;
            int c = cur.cnt;
            // cout &lt;&lt; x &lt;&lt; &quot; &quot; &lt;&lt; y &lt;&lt; &quot; &quot; &lt;&lt; cur.dist &lt;&lt; &quot; &quot; &lt;&lt; c &lt;&lt; endl;
            if (x == n - 1 &amp;&amp; y == m - 1) {
<A NAME="1"></A>                // cout &lt;&lt; c &lt;&lt; endl;
                return cur.dist;
            }
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match19-1.html#1',3,'match19-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>            for (int i = 0; i &lt; 4; ++i) {
                int a = x + dx[i];
                int b = y + dy[i];
                
                if (a &lt; 0 || b &lt; 0 || a &gt;= n || b &gt;= m) continue;
                if (st[a][b].count(c)) continue;       </B></FONT>
                if (grid[a][b] == 1 &amp;&amp; c == k) continue;
                
                st[a][b].insert(c);

                Step temp;
                temp.dist = cur.dist + 1;
                temp.cost = temp.dist + n - 1 - a + m - 1 - b;
                temp.x = a;
                temp.y = b;
                temp.cnt = c;
                if (grid[a][b] == 1) 
                    temp.cnt += 1;
                heap.push(temp);
            }
        }
        
        return -1;
    }
};
</PRE>
</BODY>
</HTML>
