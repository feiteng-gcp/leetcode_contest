<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>31_liang5.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>31_liang5.cpp</CENTER></H3><HR>
<PRE>
struct ST {
    int x, y, k, step;
    ST(): x(0),y(0),k(0),step(0){}
    ST(int _x, int _y, int _k, int _step):
<A NAME="0"></A>    x(_x), y(_y), k(_k), step(_step) {}
} q[42*42*42*42];

<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match13-1.html#0',3,'match13-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>const int dir[][2] = {{-1,0},{1,0},{0,-1},{0,1}};

class Solution {
public:
    int m, n;
    int vis[42][42][42*42];
    int shortestPath(vector&lt;vector&lt;int&gt;&gt;&amp; grid, int k) {</B></FONT>
        m = grid.size(); n = grid[0].size();
        memset(vis, 0, sizeof(vis));
        q[0] = ST(0, 0, 0, 0);
        vis[0][0][0] = 1;
        int ans = 1e9;
        int qh, qt;
        for (qh = 0 , qt = 1 ; qh &lt; qt ; ++qh) {
            // printf(&quot;[%d,%d,%d,%d]\n&quot;, q[qh].x, q[qh].y, q[qh].k, q[qh].step);
<A NAME="1"></A>            if (q[qh].x == m-1 &amp;&amp; q[qh].y == n-1) {
                ans = min(ans, q[qh].step);
            }
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match13-1.html#1',3,'match13-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>            for (int d = 0 ; d &lt; 4 ; ++d) {
                int tx = q[qh].x + dir[d][0];
                int ty = q[qh].y + dir[d][1];
                if (tx &lt; 0 || tx &gt;= m || ty &lt; 0 || ty &gt;= n) continue;
                int tk;</B></FONT>
                if (grid[tx][ty]) {
                    tk = q[qh].k + 1;
                    if (tk &gt; k) continue;
                } else {
                    tk = q[qh].k;
                }
                if (vis[tx][ty][tk]) continue;
                vis[tx][ty][tk] = 1;
                q[qt] = ST(tx, ty, tk, q[qh].step+1);
                ++qt;
            }
        }
        if (ans == 1e9) return -1;
        return ans;
    }
};
</PRE>
</BODY>
</HTML>
