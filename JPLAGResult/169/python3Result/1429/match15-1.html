<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>133_neophytep.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>133_neophytep.py</CENTER></H3><HR>
<PRE>
class Solution:
    def isSolvable(self, words: List[str], result: str) -&gt; bool:
        def preEvaluate(words, result, mapping):               
            test = sum([mapping[word[-1]] for word in words])
            return test%10 == mapping[result[-1]]
            
        def evaluate(words, result, mapping):
            test = 0
            for word in words:
                temp = 0
                for ch in word:
                    temp = temp*10 + mapping[ch]
                test += temp
            
            testResult = 0
            for ch in result:
                testResult = testResult*10 + mapping[ch]
            
            # print(words, result, mapping, test, testResult)
            return test == testResult
        
        def tryMap(i,n,chList,lead,mapping,words,result,available,last):
            if i == n:
                return evaluate(words,result,mapping)
            
            if i == len(last):
                if not preEvaluate(words,result,mapping):
<A NAME="0"></A>                    return False
            
            for j in list(available):
                <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match15-0.html#0',2,'match15-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>if j==0 and chList[i] in lead: # or not preEvaluate(words,result,mapping):
                    continue
                    
                available.discard(j)
                mapping[chList[i]] = j
                if tryMap(i+1,n,chList,lead,mapping,words,result,available,last):
                    r</B></FONT>eturn True
                del mapping[chList[i]]
                available.add(j)
            
            return False
            
            
        chSet, lead, lastDigitSet = set(), set(), set([result[-1]])
        for word in words:
            lastDigitSet.add(word[-1])
            for i,ch in enumerate(word):
                if i==0:
                    lead.add(ch)
                chSet.add(ch)
        
        for i, ch in enumerate(result):
            if i==0:
                lead.add(ch)
            chSet.add(ch)
        
        whole, last = list(lastDigitSet), list(lastDigitSet)
        for ch in chSet:
            if ch not in lastDigitSet:
                whole.append(ch)
        
        return tryMap(0,len(chSet),whole,lead,{},words,result,set(list(range(10))),last)
            
</PRE>

</BODY>
</HTML>
