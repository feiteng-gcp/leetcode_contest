<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>51_Hexadecimal.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>51_Hexadecimal.py</CENTER></H3><HR>
<PRE>
class Solution:
    def isSolvable(self, words: List[str], result: str) -&gt; bool:
        
        def consi():
            ca = 0
            for i in range(-1, -ll - 1, -1):
                left = ca
                for j in words:
                    if i + len(j) &gt;= 0:
                        if j[i] in m:
                            left += m[j[i]]
                        else:
                            break
                else:
                    if result[i] not in m:
                        return True
                    if left % 10 != m[result[i]]:
                        return False
                    ca = left // 10
                    continue
                return True  
            return ca == 0            
        
        def valid():
            i = 0
            for w in words:
                i += int(''.join(str(m[c]) for c in w))
            return i == int(''.join(str(m[c]) for c in result))
        
        def search(x):
            nonlocal m, used
            if x == n:
                ret = valid()
                return ret
            for i in range(10):
                if i == 0 and s[x] in init:
                    continue
<A NAME="0"></A>                if i not in used:
                    used.add(i)
                    m[s[x]] = i
                    if consi() and search<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match13-1.html#0',3,'match13-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>(x + 1):
                        return True
                    del m[s[x]]
                    used.discard(i)
            r</B></FONT>eturn False
            
        s = []
        ws = words + [result]
        init = set(w[0] for w in ws)
        ll = max(len(u) for u in words)
        if ll &gt; len(result):
            return False
        ll = len(result)
        for i in range(-1, -ll - 1, -1):
            for j in ws:
                if i + len(j) &gt;= 0 and j[i] not in s:
                    s.append(j[i])
        n = len(s)
        m = dict()
        used = set()
        ret = search(0)       
        return ret
</PRE>

</BODY>
</HTML>
