<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>47_OTTFF.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>47_OTTFF.cpp</CENTER></H3><HR>
<PRE>
class Solution {
public:
    vector&lt;int&gt; vis;
    unordered_map&lt;char,int&gt; ma;
    vector&lt;string&gt; wd;
    string res;
    int n;
    int f=0;
    int mj;
    void dfs(int i,int j,int ans)
    {
        //cout&lt;&lt;i&lt;&lt;&quot; &quot;&lt;&lt;j&lt;&lt;&quot; &quot;&lt;&lt;ans&lt;&lt;endl;
        if(f) return;
        if(i==n)
        {
            //cout&lt;&lt;i&lt;&lt;&quot; &quot;&lt;&lt;j&lt;&lt;&quot; &quot;&lt;&lt;ans&lt;&lt;endl;
            if(j==mj)
            {
                if(ans==0)
                {
                    f=1;
                    // for(auto p:ma)
                    //     if(p.second!=-1) cout&lt;&lt;p.first&lt;&lt;&quot; &quot;&lt;&lt;p.second&lt;&lt;endl;
                }
                return;
            }
            if(res.length()&lt;=j) return;
            char c=res[j];
            if(ma[c]==-1)
            {
                if(vis[ans%10]||(res.length()-1==j&amp;&amp;ans%10==0)) return;
                vis[ans%10]=1;
                ma[c]=ans%10;
                dfs(0,j+1,ans/10);
                ma[c]=-1;
                vis[ans%10]=0;
            }
            else if(ma[c]!=ans%10) return;
            dfs(0,j+1,ans/10);
            return;
        }
        if(wd[i].length()&lt;=j)
        {
            dfs(i+1,j,ans);
            return;
        }
        char c=wd[i][j];
        if(ma[c]!=-1)
<A NAME="0"></A>        {
            if(wd[i].length()-1==j&amp;&amp;ma[c]==0) return;
            dfs(i+1,j,ans+ma[c]);
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match23-0.html#0',2,'match23-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>            return;
        }
        for(int k=0;k&lt;10;k++)
        {
            if(vis[k]) continue;
            if(k==0&amp;&amp;wd[i].length()-1==j) continue;
            vis[k]=1;
            ma[c]=k;
            dfs(i+1,j,ans+k);
            ma[c]=-1;</B></FONT>
            vis[k]=0;
        }
    }
    bool isSolvable(vector&lt;string&gt;&amp; words, string result) {
        res=result;
        reverse(res.begin(),res.end());
        mj=0;
        for(string s:words)
        {
            reverse(s.begin(),s.end());
            wd.push_back(s);
            mj=max(mj,(int)s.length());
        }
        if(res.length()&lt;mj) return false;
        mj=max(mj,(int)res.length());
        n=wd.size();
        for(int i=0;i&lt;26;i++)
            ma[i+'A']=-1;
        vis.assign(10,0);
        dfs(0,0,0);
        return f;
    }
};
/*
[&quot;SEND&quot;,&quot;MORE&quot;]
&quot;MONEY&quot;
[&quot;SIX&quot;,&quot;SEVEN&quot;,&quot;SEVEN&quot;]
&quot;TWENTY&quot;
[&quot;THIS&quot;,&quot;IS&quot;,&quot;TOO&quot;]
&quot;FUNNY&quot;
[&quot;LEET&quot;,&quot;CODE&quot;]
&quot;POINT&quot;
*/
</PRE>
</BODY>
</HTML>
