<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>80_bell-10.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>80_bell-10.java</CENTER></H3><HR>
<PRE>
<A NAME="0"></A>class Solution {

  <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match10-1.html#0',3,'match10-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>public boolean isSolvable(String[] words, String result) {
    this.words = words;
    this.result = result;
    int maxWordLength = Arrays.stream</B></FONT>(words).mapToInt(w -&gt; w.length()).max().orElse(0);
    if (result.length() &lt; maxWordLength) return false;

    Mapping mapping = new Mapping();
    return solvable(mapping, 0, 0);
  }
<A NAME="1"></A>  String[] words;
  String result;

  <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match10-1.html#1',3,'match10-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>private boolean solvable(Mapping mapping, int place, int incr) {
    if (place &gt;= result.length()) {
      return incr == 0;
    }

<A NAME="2"></A>    List&lt;Character&gt; inputChars = new ArrayList&lt;&gt;();
    for (String word : words) {
      if (word.length</B></FONT>() &gt; place)
        inputChars.add(word.charAt(word.length() - 1 - place))<FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match10-1.html#2',3,'match10-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>;
    }
    return solvable2(mapping, place, incr, inputChars, 0);
  }
  private boolean solvable2(Mapping mapping, int place, int incr, List&lt;Character&gt; inputChars, int charI) {
    while (charI &lt; inputChars.size()) {
      char c = inputChars.get(charI);
      if (!mapping.hasValue(c)) {
        for (int digit = 0; digit &lt; 10; digit++) {
<A NAME="3"></A>          if (!mapping.canSet</B></FONT>(digit)) continue;
          Mapping next = new Mapping(mapping);
          next.set(c, digit);
          if (solvable2(next, place, incr, inputChars, charI + 1)) return true<FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match10-1.html#3',3,'match10-top.html#3',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>;
        }
        return false;
      }
      charI++;
    }

    int sum = inputChars.stream().mapToInt(c -&gt; mapping.</B></FONT>get(c)).sum() + incr;
    int resultValue = sum % 10;
    char resultChar = result.charAt(result.length() - 1 - place);
<A NAME="4"></A>    if (mapping.hasValue(resultChar)) {
      if (mapping.get(resultChar) != resultValue) return false;
    } else {
      if (!mapping.canSet(resultValue)) return false<FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match10-1.html#4',3,'match10-top.html#4',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>;
      mapping.set(resultChar, resultValue);
    }
    return solvable(mapping, place + 1, sum / 10);
  }

  private static class Mapping {
    private int[] alphabet = new int[26];
    private Set&lt;Integer&gt; leftDigits = new HashSet&lt;&gt;();
    public Mapping() {
      Arrays.fill(alphabet, -1);
      leftDigits.addAll(IntStream.range(0, 10).boxed().collect(Collectors.toList()));
    }
    public Mapping(Mapping template) {
      System.arraycopy(template.alphabet, 0, alphabet, 0, 26);
      leftDigits.addAll(template.leftDigits);
    }

    public boolean hasValue(char c) {
      return alphabet[c - 'A'] &gt;= 0;
    }
    public int get(char c) {
      return alphabet[c - 'A'];
    }
    public boolean canSet(int v) {
      return leftDigits.contains(v);
    }
    public void set(char c, int v) {
      leftDigits.remove(v);
      alphabet[c - 'A'] = v;
    }
  }

}</B></FONT>
</PRE>

</BODY>
</HTML>
