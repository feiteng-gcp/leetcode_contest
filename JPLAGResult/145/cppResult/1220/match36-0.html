<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>42_liouzhou_101.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>42_liouzhou_101.cpp</CENTER></H3><HR>
<PRE>
const int MAXN = 62;

using bits = bitset&lt;32&gt;;

bits all[MAXN];

vector&lt;bits&gt; v;

int N, M;
vector&lt;int&gt; opt[MAXN];
int L[MAXN], R[MAXN];

int best;

vector&lt;int&gt; ans, cur;

void dfs(int depth)
{
	if (depth &gt;= best) return;
    /*
    printf(&quot;%d\n&quot;, depth);
    if (depth == 4)
    {
        printf(&quot;%d\n&quot;, R[0]);
    }
    */
	if (R[0] == M+1)
	{
		best = depth;
        ans = cur;
		return;
	}
	int chosen = 0;
	for (int i = R[0]; i &lt;= M; i = R[i])
		if (!chosen || opt[i].size() &lt; opt[chosen].size()) chosen = i;
    
    //printf(&quot;%d: %d %d\n&quot;, depth, chosen, opt[chosen].size());
    
	for (auto x : opt[chosen])
	{
		vector&lt;int&gt; covered;
		for (int i = R[0]; i &lt;= M; i = R[i])
			if (v[x-1][i-1])
				covered.push_back(i);
		
		for (auto i : covered)
		{
			R[L[i]] = R[i];
			L[R[i]] = L[i];
		}
		
		bits cur;
		int cost = 0;
		for (int i = R[0]; i &lt;= M; i = R[i])
		{
			if (!cur[i-1])
			{
				++ cost;
				cur |= all[i-1];
			}
		}
		if (depth+cost &lt; best)
		{
            //printf(&quot;%d- %d\n&quot;, depth, x);
            ::cur.push_back(x-1);
			dfs(depth+1);
            ::cur.pop_back();
		}
		
		reverse(covered.begin(), covered.end());
		for (auto i : covered)
		{
			R[L[i]] = i;
			L[R[i]] = i;
		}
	}
}

class Solution {
public:
    vector&lt;int&gt; smallestSufficientTeam(vector&lt;string&gt;&amp; req_skills, vector&lt;vector&lt;string&gt;&gt;&amp; people) {
        int n = people.size();
        v.resize(n);
<A NAME="0"></A>        for (int i = 0; i &lt; n; ++ i)
        {
            v[i].reset();
<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match36-1.html#0',3,'match36-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>            for (auto skill : people[i])
            {
                for (int j = 0; j &lt; req_skills.size(); ++ j)
                    if (skill == req_skills[j])
                    {
                        v[i][j] = 1;
                        break;
                    }
            }
        }
        
        N = n;</B></FONT>
        M = req_skills.size();
        
        R[0] = 1;
		for (int j = 1; j &lt;= M; ++ j)
		{
			L[j] = j-1;
			R[j] = j+1;
			opt[j].clear();
			all[j-1].reset();
		}
		L[M+1] = M;
        
        for (int i = 0; i &lt; N; ++ i)
		{
			for (int j = 0; j &lt; M; ++ j)
			{
				if (v[i][j])
				{
					opt[j+1].push_back(i+1);
					all[j] |= v[i];
				}
			}
		}
        
        best = M+1;
        cur.clear();
		dfs(0);
        return ans;
    }
};
</PRE>
</BODY>
</HTML>
